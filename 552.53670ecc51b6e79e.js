(self.webpackChunkawg_app=self.webpackChunkawg_app||[]).push([[552],{6552:(q,Ne,I)=>{"use strict";I.r(Ne),I.d(Ne,{EditionGraphModule:()=>hn});var G=I(655),w=I(5e3),Fe=I(9822),V=I(3338),Te=I(1451);let be=class{constructor(){this.clickedNodeRequest=new w.vpe}onGraphNodeClick(e){!e||this.clickedNodeRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}};be.propDecorators={queryResult$:[{type:w.IIB}],defaultForceGraphHeight:[{type:w.IIB}],isFullscreen:[{type:w.IIB}],clickedNodeRequest:[{type:w.r_U}]},be=(0,G.gn)([(0,w.wA2)({selector:"awg-construct-results",template:V,changeDetection:w.n4l.OnPush,styles:[Te]})],be);var qe=I(5534),Ae=I(9020),ve=I(7579),Pe=I(8372),we=I(2722),te=I(801);class S{constructor(){this.nodes=[],this.links=[],this.nodeTriples=[]}}class E{constructor(e,n){this.source=e,this.target=n,this.predicate="",this.weight=1}}var O,t,ze,ne;(t=O||(O={})).link="link",t.node="node";class ae{constructor(e,n){this.id=e,this.label=e,this.weight=1,this.type=n,this.owlClass=!1,this.instance=!1}}class wr{constructor(e,n,r){this.nodeSubject=e,this.nodePredicate=n,this.nodeObject=r}}!function(t){t.TURTLE="TURTLE",t.SPARQL="SPARQL"}(ze||(ze={})),function(t){t.short="short",t.long="long"}(ne||(ne={}));class Y{constructor(e,n){this.prefixName=e,this.prefixIri=n}}const Rr=[new Y("awg","https://edition.anton-webern.ch/webern-onto#"),new Y("dbo","http://dbpedia.org/ontology/"),new Y("dbp","http://dbpedia.org/property/"),new Y("dbpedia","http://dbpedia.org/resource/"),new Y("dc","http://purl.org/dc/elements/1.1/"),new Y("dcterms","http://purl.org/dc/terms/"),new Y("foaf","http://xmlns.com/foaf/0.1/"),new Y("mo","http://purl.org/ontology/mo/"),new Y("owl","http://www.w3.org/2002/07/owl#"),new Y("prov","http://www.w3.org/ns/prov#"),new Y("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),new Y("rdfs","http://www.w3.org/2000/01/rdf-schema#"),new Y("skos","http://www.w3.org/2004/02/skos/core#"),new Y("xsd","http://www.w3.org/2001/XMLSchema#")];let De=class{constructor(){this.defaultPrefixes=Rr}transform(e,n){let r;switch(n){case ne.short:this.defaultPrefixes.forEach(s=>{-1!==e.indexOf(s.prefixIri)&&(r=e.replace(s.prefixIri,s.prefixName+":"))});break;case ne.long:this.defaultPrefixes.forEach(s=>{-1!==e.indexOf(s.prefixName)&&(r=e.replace(s.prefixName+":",s.prefixIri))});break;default:const i=n;throw new Error(`The prefixForm must be ${ne.short} or ${ne.long}, but was: ${i}.`)}return r||e}};De=(0,G.gn)([(0,w.E6H)({name:"prefix",pure:!1})],De);const Qe="http://www.w3.org/1999/02/22-rdf-syntax-ns#",He="http://www.w3.org/2001/XMLSchema#",Pt="http://www.w3.org/2000/10/swap/",oe={xsd:{decimal:`${He}decimal`,boolean:`${He}boolean`,double:`${He}double`,integer:`${He}integer`,string:`${He}string`},rdf:{type:`${Qe}type`,nil:`${Qe}nil`,first:`${Qe}first`,rest:`${Qe}rest`,langString:`${Qe}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${Pt}reify#forSome`,forAll:`${Pt}reify#forAll`},log:{implies:`${Pt}log#implies`}};var Sr=I(352),Nr=I.n(Sr);const{xsd:st}=oe,Tr=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,dn={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},kr=/[\x00-\x20<>\\"\{\}\|\^\`]/,Cr={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},Ir=/$0^/;class Er{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const n in this)!(n in Cr)&&this[n]instanceof RegExp&&(this[n]=Ir)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,n){let r=this._input,i=r.length;for(;;){let o,l;for(;o=this._newline.exec(r);)this._comments&&(l=this._comment.exec(o[0]))&&s("comment",l[1],"",this._line,o[0].length),r=r.substr(o[0].length,r.length),i=r.length,this._line++;if(!o&&(o=this._whitespace.exec(r))&&(r=r.substr(o[0].length,r.length)),this._endOfFile.test(r))return n&&(this._comments&&(l=this._comment.exec(r))&&s("comment",l[1],"",this._line,r.length),r=null,s("eof","","",this._line,0)),this._input=r;const u=this._line,c=r[0];let f="",h="",d="",x=null,m=0,y=!1;switch(c){case"^":if(r.length<3)break;if("^"!==r[1]){this._n3Mode&&(m=1,f="^");break}if(this._previousMarker="^^",r=r.substr(2),"<"!==r[0]){y=!0;break}case"<":if(x=this._unescapedIri.exec(r))f="IRI",h=x[1];else if(x=this._iri.exec(r)){if(h=this._unescape(x[1]),null===h||kr.test(h))return a(this);f="IRI"}else r.length>1&&"<"===r[1]?(f="<<",m=2):this._n3Mode&&r.length>1&&"="===r[1]&&(f="inverse",m=2,h=">");break;case">":r.length>1&&">"===r[1]&&(f=">>",m=2);break;case"_":((x=this._blank.exec(r))||n&&(x=this._blank.exec(`${r} `)))&&(f="blank",d="_",h=x[1]);break;case'"':if(x=this._simpleQuotedString.exec(r))h=x[1];else if(({value:h,matchLength:m}=this._parseLiteral(r)),null===h)return a(this);(null!==x||0!==m)&&(f="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(x=this._simpleApostropheString.exec(r))h=x[1];else if(({value:h,matchLength:m}=this._parseLiteral(r)),null===h)return a(this);(null!==x||0!==m)&&(f="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(x=this._variable.exec(r))&&(f="var",h=x[0]);break;case"@":"literal"===this._previousMarker&&(x=this._langcode.exec(r))?(f="langcode",h=x[1]):(x=this._keyword.exec(r))&&(f=x[0]);break;case".":if(1===r.length?n:r[1]<"0"||r[1]>"9"){f=".",m=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(x=this._number.exec(r)||n&&(x=this._number.exec(`${r} `)))&&(f="literal",h=x[0],d="string"==typeof x[1]?st.double:"string"==typeof x[2]?st.decimal:st.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(x=this._sparqlKeyword.exec(r))?f=x[0].toUpperCase():y=!0;break;case"f":case"t":(x=this._boolean.exec(r))?(f="literal",h=x[0],d=st.boolean):y=!0;break;case"a":(x=this._shortPredicates.exec(r))?(f="abbreviation",h="a"):y=!0;break;case"=":this._n3Mode&&r.length>1&&(f="abbreviation",">"!==r[1]?(m=1,h="="):(m=2,h=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(m=1,f=c);break;default:y=!0}if(y&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(x=this._prefix.exec(r))?((x=this._prefixed.exec(r))||n&&(x=this._prefixed.exec(`${r} `)))&&(f="prefixed",d=x[1]||"",h=this._unescape(x[2])):(f="prefix",h=x[1]||"")),"^^"===this._previousMarker)switch(f){case"prefixed":f="type";break;case"IRI":f="typeIRI";break;default:f=""}if(!f)return n||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?a(this):this._input=r;const _=m||x[0].length,R=s(f,h,d,u,_);this.previousToken=R,this._previousMarker=f,r=r.substr(_,r.length)}function s(o,l,u,c,f){const h=r?i-r.length:i,x={type:o,value:l,prefix:u,line:c,start:h,end:h+f};return e(null,x),x}function a(o){e(o._syntaxError(/^\S*/.exec(r)[0]))}}_unescape(e){let n=!1;const r=e.replace(Tr,(i,s,a,o)=>{if("string"==typeof s)return String.fromCharCode(Number.parseInt(s,16));if("string"==typeof a){let l=Number.parseInt(a,16);return l<=65535?String.fromCharCode(Number.parseInt(a,16)):String.fromCharCode(55296+((l-=65536)>>10),56320+(1023&l))}return o in dn?dn[o]:(n=!0,"")});return n?null:r}_parseLiteral(e){if(e.length>=3){const n=e.match(/^(?:"""|"|'''|'|)/)[0],r=n.length;let i=Math.max(this._literalClosingPos,r);for(;(i=e.indexOf(n,i))>0;){let s=0;for(;"\\"===e[i-s-1];)s++;if(s%2==0){const a=e.substring(r,i),o=a.split(/\r\n|\r|\n/).length-1,l=i+r;if(1===r&&0!==o||3===r&&this._lineMode)break;return this._line+=o,{value:this._unescape(a),matchLength:l}}i++}this._literalClosingPos=e.length-r+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const n=new Error(`Unexpected "${e}" on line ${this._line}.`);return n.context={token:void 0,line:this._line,previousToken:this.previousToken},n}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,n){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof n){const r=[];let i;if(this._tokenizeToEnd((s,a)=>s?i=s:r.push(a),!0),i)throw i;return r}Nr()(()=>this._tokenizeToEnd(n,!0))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",r=>{null!==this._input&&0!==r.length&&(this._pendingBuffer&&(r=Buffer.concat([this._pendingBuffer,r]),this._pendingBuffer=null),128&r[r.length-1]?this._pendingBuffer=r:(void 0===this._input?this._input=this._readStartingBom("string"==typeof r?r:r.toString()):this._input+=r,this._tokenizeToEnd(n,!1)))}),e.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(n,!0)}),e.on("error",n)}}const{rdf:Fr,xsd:ke}=oe;let Ve,qr=0;const zt={namedNode:function Or(t){return new gn(t)},blankNode:function jr(t){return new zr(t||"n3-"+qr++)},variable:function $r(t){return new Dr(t)},literal:function Gr(t,e){if("string"==typeof e)return new Le(`"${t}"@${e.toLowerCase()}`);let n=e?e.value:"";return""===n&&("boolean"==typeof t?n=ke.boolean:"number"==typeof t&&(Number.isFinite(t)?n=Number.isInteger(t)?ke.integer:ke.double:(n=ke.double,Number.isNaN(t)||(t=t>0?"INF":"-INF")))),""===n||n===ke.string?new Le(`"${t}"`):new Le(`"${t}"^^${n}`)},defaultGraph:function Br(){return Ve},quad:_n,triple:_n},Pr=zt;class de{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof de?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class gn extends de{get termType(){return"NamedNode"}}class Le extends de{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let n=e.lastIndexOf('"')+1;return n<e.length&&"@"===e[n++]?e.substr(n).toLowerCase():""}get datatype(){return new gn(this.datatypeString)}get datatypeString(){const e=this.id,n=e.lastIndexOf('"')+1,r=n<e.length?e[n]:"";return"^"===r?e.substr(n+2):"@"!==r?ke.string:Fr.langString}equals(e){return e instanceof Le?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class zr extends de{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class Dr extends de{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}Ve=new class Lr extends de{constructor(){return super(""),Ve||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};class Mr extends de{constructor(e,n,r,i){super(""),this._subject=e,this._predicate=n,this._object=r,this._graph=i||Ve}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function _n(t,e,n,r){return new Mr(t,e,n,r)}let mn=0;class Lt{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&yn(this,e.factory);const n="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",r=/turtle/.test(n),i=/trig/.test(n),s=/triple/.test(n),a=/quad/.test(n),o=this._n3Mode=/n3/.test(n),l=s||a;(this._supportsNamedGraphs=!(r||o))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||i||s||o),this._supportsRDFStar=""===n||/star|\*$/.test(n),l&&(this._resolveRelativeIRI=u=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new Er({lineMode:l,n3:o}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){mn=0}_setBase(e){if(e){const n=e.indexOf("#");n>=0&&(e=e.substr(0,n)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,n,r,i,s){const a=this._n3Mode;this._contextStack.push({type:e,subject:r,predicate:i,object:s,graph:n,inverse:!!a&&this._inversePredicate,blankPrefix:a?this._prefixes._:"",quantified:a?this._quantified:null}),a&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,n){const r=this._contextStack.pop();if(!r||r.type!==e)return this._error(`Unexpected ${n.type}`,n);this._subject=r.subject,this._predicate=r.predicate,this._object=r.object,this._graph=r.graph,this._n3Mode&&(this._inversePredicate=r.inverse,this._prefixes._=r.blankPrefix,this._quantified=r.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,n){let r;switch(e.type){case"IRI":case"typeIRI":const i=this._resolveIRI(e.value);if(null===i)return this._error("Invalid IRI",e);r=this._namedNode(i);break;case"type":case"prefixed":const s=this._prefixes[e.prefix];if(void 0===s)return this._error(`Undefined prefix "${e.prefix}:"`,e);r=this._namedNode(s+e.value);break;case"blank":r=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":r=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!n&&this._n3Mode&&r.id in this._quantified&&(r=this._quantified[r.id]),r}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const n=e.type;switch(n){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${n}`,e):(this._subject=null,"]"===n?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const n=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:n?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let n=null,r=null,i=this._readListItem;const s=this._subject,a=this._contextStack,o=a[a.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,r=this._blankNode(),this.RDF_FIRST,this._subject=n=this._blankNode()),i=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==a.length&&"list"===a[a.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(i=this._readPredicate,this._subject===this.RDF_NIL)return i}else if(i=this._getContextEndReader(),this._object===this.RDF_NIL)return i;r=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,i=this._readListItemDataTypeOrLang):(n=this._literal(e.value,this._namedNode(e.prefix)),i=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(n=this._readEntity(e)))return}if(null===r&&(this._subject=r=this._blankNode()),null===s?null===o.predicate?o.subject=r:o.object=r:this._emit(s,this.RDF_REST,r,this._graph),null!==n){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,r,this.RDF_FIRST,n),this._subject=n,this._predicate=null,this._getPathReader(this._readListItem);this._emit(r,this.RDF_FIRST,n,this._graph)}return i}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let n=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const r=this._readEntity(e);if(void 0===r)return;n=this._literal(this._literalValue,r),e=null;break;case"langcode":n=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:n}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,n){const r=this._completeLiteral(e);if(r)return this._object=r.literal,n&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===r.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(r.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let n,r=this._graph;const i=this._subject,s=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,n=this._contextStack.length?this._readSubject:this._readInTopContext,s&&(this._inversePredicate=!1);break;case";":n=this._readPredicate;break;case",":n=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(e))){n=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==i){const a=this._predicate,o=this._object;s?this._emit(o,a,i,r):this._emit(i,a,o,r)}return n}_readBlankNodePunctuation(e){let n;switch(e.type){case";":n=this._readPredicate;break;case",":n=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),n}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const n=this._readEntity(e);return this._prefixes[this._prefix]=n.value,this._prefixCallback(this._prefix,n),this._readDeclarationPunctuation}_readBaseIRI(e){const n="IRI"===e.type&&this._resolveIRI(e.value);return n?(this._setBase(n),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let n;switch(e.type){case"IRI":case"prefixed":if(void 0!==(n=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,n,this.QUANTIFIERS_GRAPH)):this._quantified[n.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const n=this._contextStack,r=n.length&&n[n.length-1];if(r&&"item"===r.type){const i=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,i,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let n,r;const i=this._blankNode();if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(n=this._subject,this._subject=i):(n=this._object,this._object=i),this._emit(n,r,i,this._graph),this._readPath}_readBackwardPath(e){const n=this._blankNode();let r,i;if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=n):(i=this._object,this._object=n),this._emit(n,r,i,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const n=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=n,this._readPredicate):(this._object=n,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,n,r,i){this._callback(null,this._quad(e,n,r,i||this.DEFAULTGRAPH))}_error(e,n){const r=new Error(`${e} on line ${n.line}.`);r.context={token:n,line:n.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=Mt}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const n=e.length;let r="",i=-1,s=-1,a=0,o="/";for(;i<n;){switch(o){case":":if(s<0&&"/"===e[++i]&&"/"===e[++i])for(;(s=i+1)<n&&"/"!==e[s];)i=s;break;case"?":case"#":i=n;break;case"/":if("."===e[i+1])switch(o=e[1+ ++i],o){case"/":r+=e.substring(a,i-1),a=i+1;break;case void 0:case"?":case"#":return r+e.substring(a,i)+e.substr(i+1);case".":if(o=e[1+ ++i],void 0===o||"/"===o||"?"===o||"#"===o){if(r+=e.substring(a,i-2),(a=r.lastIndexOf("/"))>=s&&(r=r.substr(0,a)),"/"!==o)return`${r}/${e.substr(i+1)}`;a=i+1}}}o=e[++i]}return r+e.substring(a)}parse(e,n,r){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${mn++}_`,this._prefixCallback=r||Mt,this._inversePredicate=!1,this._quantified=Object.create(null),!n){const i=[];let s;if(this._callback=(a,o)=>{a?s=a:o&&i.push(o)},this._lexer.tokenize(e).every(a=>this._readCallback=this._readCallback(a)),s)throw s;return i}this._callback=n,this._lexer.tokenize(e,(i,s)=>{null!==i?(this._callback(i),this._callback=Mt):this._readCallback&&(this._readCallback=this._readCallback(s))})}}function Mt(){}function yn(t,e){const n=e.namedNode;t._namedNode=n,t._blankNode=e.blankNode,t._literal=e.literal,t._variable=e.variable,t._quad=e.quad,t.DEFAULTGRAPH=e.defaultGraph(),t.RDF_FIRST=n(oe.rdf.first),t.RDF_REST=n(oe.rdf.rest),t.RDF_NIL=n(oe.rdf.nil),t.N3_FORALL=n(oe.r.forAll),t.N3_FORSOME=n(oe.r.forSome),t.ABBREVIATIONS={a:n(oe.rdf.type),"=":n(oe.owl.sameAs),">":n(oe.log.implies)},t.QUANTIFIERS_GRAPH=n("urn:n3:quantifiers")}yn(Lt.prototype,Pr);let Me=class{constructor(e){this.prefixPipe=e}parseTripleString(e){const n=new Lt,r=[];return new Promise((i,s)=>{n.parse(e,(a,o,l)=>{o?r.push(o):i({triples:r,namespaces:l}),a&&s(a)})})}limitTriples(e,n){return e?e.length>n?e.slice(0,n):e:[]}abbreviateTriples(e,n,r){return r||(r="text/turtle"),e.map(i=>{let s=i.subject.nominalValue,a=i.predicate.nominalValue,o=i.object.nominalValue;return"text/turtle"===r&&(null!=this._abbreviate(s,n)&&(s=this._abbreviate(s,n)),null!=this._abbreviate(a,n)&&(a=this._abbreviate(a,n)),null!=this._abbreviate(o,n)&&(o=this._abbreviate(o,n))),{subject:s,predicate:a,object:o}})}checkNamespacesInQuery(e,n){if(!e||!n)return;const r=this._extractNamespacesFromString(ze.TURTLE,n),i=this._extractNamespacesFromString(ze.SPARQL,e),s=this._extractQNamesFromSPARQLWhereClause(e),a=Object.keys(r),o=Object.keys(i);let l="";return a.forEach(u=>{-1===o.indexOf(u)&&(l+=`PREFIX ${u} ${r[u]}\n`)}),s.length>0&&s.forEach(u=>{if(-1===o.indexOf(u)){console.warn(`Prefix '${u}' not declared in SPARQL and/or Turtle header. Searching in default namespaces...`);const c=this.prefixPipe.transform(u,ne.long);if(c!==u){const f=`PREFIX ${u} <${c}>\n`;l+=f,console.warn(`Added '${f}' to SPARQL prefixes from list of default namespaces.`)}else console.warn(`'${u}' is unknown. Please provide a declaration.`)}}),""!==l&&(e=l+e),e}doQuery(e,n,r,i){return i||(i="text/turtle"),this._createStore().then(s=>(this._store=s,this._loadTriplesInStore(s,r,i))).then(s=>this._executeQuery(this._store,n)).then(s=>{if("select"===e){const a=s;return this._prepareSelectResponse(a).data}if("construct"===e){const a=s;return this._getNamespaces(r).then(o=>this.abbreviateTriples(a.triples,o,i))}})}getQuerytype(e){let n=[{queryType:"select",index:-1},{queryType:"construct",index:-1},{queryType:"ask",index:-1},{queryType:"count",index:-1},{queryType:"describe",index:-1},{queryType:"insert",index:-1},{queryType:"delete",index:-1}],r=!1,i=1/0;if(n=n.map(o=>(o.index=e.toLowerCase().indexOf(o.queryType),-1!==o.index&&(r=!0,o.index<i&&(i=o.index)),o)),!r)return null;let a=n.find(o=>o.index===i).queryType;return("insert"===a||"delete"===a)&&(a="update"),a}_abbreviate(e,n){let r=e;return-1!==e.indexOf("http")&&Object.entries(n).forEach(([i,s])=>{-1!==e.indexOf(s)&&(r=e.replace(s,i+":"))}),r}_createStore(){return new Promise((e,n)=>{rdfstore.create((r,i)=>{r&&n(r),e(i)})})}_executeQuery(e,n){return new Promise((r,i)=>{e.execute(n,(s,a)=>{s&&(console.error("_executeQuery# got ERROR",s),i(s)),r(a)})})}_extractNamespacesFromString(e,n){const r=n.toLowerCase().replace(/\s/g," ").split(" ").filter(o=>""!==o);let i;switch(e){case ze.TURTLE:i="@prefix".toLowerCase();break;case ze.SPARQL:i="PREFIX".toLowerCase();break;default:throw new Error(`The type must be TURTLE or SPARQL, but was: ${e}.`)}const s=r.reduce((o,l,u)=>(l===i&&o.push(u),o),[]),a={};return s.forEach(o=>{const l=r[o+1];let u=r[o+2];"."===u.at(-1)&&(u=u.slice(0,-1)),a[l]=u}),a}_extractQNamesFromSPARQLWhereClause(e){let n,r=e.toLowerCase(),i=0;const s=[],a=/\b[a-zA-Z]{2,15}:/g,o="WHERE {".toLowerCase();for(r.includes(o)&&(i=r.indexOf(o)+o.length),r=r.slice(i);null!==(n=a.exec(r));)n.index===a.lastIndex&&a.lastIndex++,n.forEach(l=>{-1===s.indexOf(l)&&s.push(l)});return s}_getNamespaces(e){const n=new Lt;return new Promise((r,i)=>{n.parse(e,(s,a,o)=>{a||r(o),s&&i(s)})})}_loadTriplesInStore(e,n,r){return r||(r="text/turtle"),new Promise((i,s)=>{e.load(r,n,(a,o)=>{a&&(console.error("_loadTriplesInStore# got error",a),s(a)),i(o)})})}_mapKeys(e,n){const r=Object.keys(e).map(i=>({[n[i]||i]:e[i]}));return Object.assign({},...r)}_prepareSelectResponse(e){if(!e)return{status:404,data:void 0};if(null==e[0])return{status:400,data:"Query returned no results"};const n=Object.keys(e[0]),r=e,i={token:"type",type:"datatype",lang:"xml:lang"};for(const a in r)if(r.hasOwnProperty(a))for(const o in n)if(n.hasOwnProperty(o)&&(r[a][n[o]]=this._mapKeys(r[a][n[o]],i),r[a][n[o]].label="",r[a][n[o]].value)){r[a][n[o]].label=this.prefixPipe.transform(r[a][n[o]].value,ne.short);const l="http://www.w3.org/2001/XMLSchema#integer",u="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",c=r[a][n[o]].type,f=r[a][n[o]].datatype||"";"literal"===c&&(f===l||f===u)&&(r[a][n[o]].label=+r[a][n[o]].value)}return{status:200,data:{head:{vars:n},body:{bindings:r}}}}};Me.ctorParameters=()=>[{type:De}],Me=(0,G.gn)([(0,w.GSi)()],Me);var Qr={value:()=>{}};function xn(){for(var r,t=0,e=arguments.length,n={};t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new lt(n)}function lt(t){this._=t}function Hr(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}function Vr(t,e){for(var i,n=0,r=t.length;n<r;++n)if((i=t[n]).name===e)return i.value}function bn(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Qr,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}lt.prototype=xn.prototype={constructor:lt,on:function(t,e){var i,n=this._,r=Hr(t+"",n),s=-1,a=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<a;)if(i=(t=r[s]).type)n[i]=bn(n[i],t.name,e);else if(null==e)for(i in n)n[i]=bn(n[i],t.name,null);return this}for(;++s<a;)if((i=(t=r[s]).type)&&(i=Vr(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new lt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,s,n=new Array(i),r=0;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,i=(s=this._[t]).length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};const ct=xn;function Ur(){}function Ot(t){return null==t?Ur:function(){return this.querySelector(t)}}function vn(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function Wr(){return[]}function wn(t){return null==t?Wr:function(){return this.querySelectorAll(t)}}function Rn(t){return function(){return this.matches(t)}}function Sn(t){return function(e){return e.matches(t)}}var Zr=Array.prototype.find;function ei(){return this.firstElementChild}var ni=Array.prototype.filter;function ri(){return Array.from(this.children)}function Nn(t){return new Array(t.length)}function ht(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function ui(t){return function(){return t}}function li(t,e,n,r,i,s){for(var o,a=0,l=e.length,u=s.length;a<u;++a)(o=e[a])?(o.__data__=s[a],r[a]=o):n[a]=new ht(t,s[a]);for(;a<l;++a)(o=e[a])&&(i[a]=o)}function ci(t,e,n,r,i,s,a){var o,l,d,u=new Map,c=e.length,f=s.length,h=new Array(c);for(o=0;o<c;++o)(l=e[o])&&(h[o]=d=a.call(l,l.__data__,o,e)+"",u.has(d)?i[o]=l:u.set(d,l));for(o=0;o<f;++o)d=a.call(t,s[o],o,s)+"",(l=u.get(d))?(r[o]=l,l.__data__=s[o],u.delete(d)):n[o]=new ht(t,s[o]);for(o=0;o<c;++o)(l=e[o])&&u.get(h[o])===l&&(i[o]=l)}function hi(t){return t.__data__}function di(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function xi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}ht.prototype={constructor:ht,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var jt="http://www.w3.org/1999/xhtml";const Tn={svg:"http://www.w3.org/2000/svg",xhtml:jt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ft(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Tn.hasOwnProperty(e)?{space:Tn[e],local:t}:t}function Ti(t){return function(){this.removeAttribute(t)}}function ki(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ci(t,e){return function(){this.setAttribute(t,e)}}function Ii(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ei(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Fi(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function kn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ai(t){return function(){this.style.removeProperty(t)}}function Pi(t,e,n){return function(){this.style.setProperty(t,e,n)}}function zi(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Oe(t,e){return t.style.getPropertyValue(e)||kn(t).getComputedStyle(t,null).getPropertyValue(e)}function Li(t){return function(){delete this[t]}}function Mi(t,e){return function(){this[t]=e}}function Oi(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Cn(t){return t.trim().split(/^|\s+/)}function Gt(t){return t.classList||new In(t)}function In(t){this._node=t,this._names=Cn(t.getAttribute("class")||"")}function En(t,e){for(var n=Gt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Fn(t,e){for(var n=Gt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Gi(t){return function(){En(this,t)}}function $i(t){return function(){Fn(this,t)}}function Bi(t,e){return function(){(e.apply(this,arguments)?En:Fn)(this,t)}}function Hi(){this.textContent=""}function Vi(t){return function(){this.textContent=t}}function Ui(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Wi(){this.innerHTML=""}function Ki(t){return function(){this.innerHTML=t}}function Yi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ji(){this.nextSibling&&this.parentNode.appendChild(this)}function ts(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rs(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===jt&&e.documentElement.namespaceURI===jt?e.createElement(t):e.createElementNS(n,t)}}function is(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function qn(t){var e=ft(t);return(e.local?is:rs)(e)}function as(){return null}function us(){var t=this.parentNode;t&&t.removeChild(this)}function cs(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function hs(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function gs(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function _s(t){return function(){var e=this.__on;if(e){for(var s,n=0,r=-1,i=e.length;n<i;++n)s=e[n],t.type&&s.type!==t.type||s.name!==t.name?e[++r]=s:this.removeEventListener(s.type,s.listener,s.options);++r?e.length=r:delete this.__on}}}function ms(t,e,n){return function(){var i,r=this.__on,s=function ps(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var a=0,o=r.length;a<o;++a)if((i=r[a]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),void(i.value=e);this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function An(t,e,n){var r=kn(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function xs(t,e){return function(){return An(this,t,e)}}function bs(t,e){return function(){return An(this,t,e.apply(this,arguments))}}In.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var $t=[null];function X(t,e){this._groups=t,this._parents=e}function Pn(){return new X([[document.documentElement]],$t)}X.prototype=Pn.prototype={constructor:X,select:function Xr(t){"function"!=typeof t&&(t=Ot(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var l,u,s=e[i],a=s.length,o=r[i]=new Array(a),c=0;c<a;++c)(l=s[c])&&(u=t.call(l,l.__data__,c,s))&&("__data__"in l&&(u.__data__=l.__data__),o[c]=u);return new X(r,this._parents)},selectAll:function Yr(t){t="function"==typeof t?function Kr(t){return function(){return vn(t.apply(this,arguments))}}(t):wn(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l,a=e[s],o=a.length,u=0;u<o;++u)(l=a[u])&&(r.push(t.call(l,l.__data__,u,a)),i.push(l));return new X(r,i)},selectChild:function ti(t){return this.select(null==t?ei:function Jr(t){return function(){return Zr.call(this.children,t)}}("function"==typeof t?t:Sn(t)))},selectChildren:function si(t){return this.selectAll(null==t?ri:function ii(t){return function(){return ni.call(this.children,t)}}("function"==typeof t?t:Sn(t)))},filter:function ai(t){"function"!=typeof t&&(t=Rn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var l,s=e[i],a=s.length,o=r[i]=[],u=0;u<a;++u)(l=s[u])&&t.call(l,l.__data__,u,s)&&o.push(l);return new X(r,this._parents)},data:function fi(t,e){if(!arguments.length)return Array.from(this,hi);var n=e?ci:li,r=this._parents,i=this._groups;"function"!=typeof t&&(t=ui(t));for(var s=i.length,a=new Array(s),o=new Array(s),l=new Array(s),u=0;u<s;++u){var c=r[u],f=i[u],h=f.length,d=di(t.call(c,c&&c.__data__,u,r)),x=d.length,m=o[u]=new Array(x),y=a[u]=new Array(x),_=l[u]=new Array(h);n(c,f,m,y,_,d,e);for(var g,k,R=0,C=0;R<x;++R)if(g=m[R]){for(R>=C&&(C=R+1);!(k=y[C])&&++C<x;);g._next=k||null}}return(a=new X(a,r))._enter=o,a._exit=l,a},enter:function oi(){return new X(this._enter||this._groups.map(Nn),this._parents)},exit:function pi(){return new X(this._exit||this._groups.map(Nn),this._parents)},join:function gi(t,e,n){var r=this.enter(),i=this,s=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&((i=e(i))&&(i=i.selection())),null==n?s.remove():n(s),r&&i?r.merge(i).order():i},merge:function _i(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,a=Math.min(i,s),o=new Array(i),l=0;l<a;++l)for(var d,u=n[l],c=r[l],f=u.length,h=o[l]=new Array(f),x=0;x<f;++x)(d=u[x]||c[x])&&(h[x]=d);for(;l<i;++l)o[l]=n[l];return new X(o,this._parents)},selection:function Rs(){return this},order:function mi(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var a,r=t[e],i=r.length-1,s=r[i];--i>=0;)(a=r[i])&&(s&&4^a.compareDocumentPosition(s)&&s.parentNode.insertBefore(a,s),s=a);return this},sort:function yi(t){function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}t||(t=xi);for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var u,a=n[s],o=a.length,l=i[s]=new Array(o),c=0;c<o;++c)(u=a[c])&&(l[c]=u);l.sort(e)}return new X(i,this._parents).order()},call:function bi(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function vi(){return Array.from(this)},node:function wi(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null},size:function Ri(){let t=0;for(const e of this)++t;return t},empty:function Si(){return!this.node()},each:function Ni(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o,i=e[n],s=0,a=i.length;s<a;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this},attr:function qi(t,e){var n=ft(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?ki:Ti:"function"==typeof e?n.local?Fi:Ei:n.local?Ii:Ci)(n,e))},style:function Di(t,e,n){return arguments.length>1?this.each((null==e?Ai:"function"==typeof e?zi:Pi)(t,e,null==n?"":n)):Oe(this.node(),t)},property:function ji(t,e){return arguments.length>1?this.each((null==e?Li:"function"==typeof e?Oi:Mi)(t,e)):this.node()[t]},classed:function Qi(t,e){var n=Cn(t+"");if(arguments.length<2){for(var r=Gt(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Bi:e?Gi:$i)(n,e))},text:function Xi(t){return arguments.length?this.each(null==t?Hi:("function"==typeof t?Ui:Vi)(t)):this.node().textContent},html:function Zi(t){return arguments.length?this.each(null==t?Wi:("function"==typeof t?Yi:Ki)(t)):this.node().innerHTML},raise:function es(){return this.each(Ji)},lower:function ns(){return this.each(ts)},append:function ss(t){var e="function"==typeof t?t:qn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function os(t,e){var n="function"==typeof t?t:qn(t),r=null==e?as:"function"==typeof e?e:Ot(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function ls(){return this.each(us)},clone:function fs(t){return this.select(t?hs:cs)},datum:function ds(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function ys(t,e,n){var i,a,r=gs(t+""),s=r.length;if(!(arguments.length<2)){for(o=e?ms:_s,i=0;i<s;++i)this.each(o(r[i],e,n));return this}var o=this.node().__on;if(o)for(var c,l=0,u=o.length;l<u;++l)for(i=0,c=o[l];i<s;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value},dispatch:function vs(t,e){return this.each(("function"==typeof e?bs:xs)(t,e))},[Symbol.iterator]:function*ws(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var a,r=t[e],i=0,s=r.length;i<s;++i)(a=r[i])&&(yield a)}};const Ue=Pn;function ue(t){return"string"==typeof t?new X([[document.querySelector(t)]],[document.documentElement]):new X([[t]],$t)}function pe(t,e){if(t=function Ss(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Ns={passive:!1},Xe={capture:!0,passive:!1};function Bt(t){t.stopImmediatePropagation()}function je(t){t.preventDefault(),t.stopImmediatePropagation()}function zn(t){var e=t.document.documentElement,n=ue(t).on("dragstart.drag",je,Xe);"onselectstart"in e?n.on("selectstart.drag",je,Xe):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Dn(t,e){var n=t.document.documentElement,r=ue(t).on("dragstart.drag",null);e&&(r.on("click.drag",je,Xe),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const dt=t=>()=>t;function Qt(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:a,y:o,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}function Ts(t){return!t.ctrlKey&&!t.button}function ks(){return this.parentNode}function Cs(t,e){return null==e?{x:t.x,y:t.y}:e}function Is(){return navigator.maxTouchPoints||"ontouchstart"in this}Qt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var pt,Ye,Ge=0,We=0,Ke=0,gt=0,Ce=0,_t=0,Ze="object"==typeof performance&&performance.now?performance:Date,Mn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ht(){return Ce||(Mn(Fs),Ce=Ze.now()+_t)}function Fs(){Ce=0}function mt(){this._call=this._time=this._next=null}function Vt(t,e,n){var r=new mt;return r.restart(t,e,n),r}function On(){Ce=(gt=Ze.now())+_t,Ge=We=0;try{!function qs(){Ht(),++Ge;for(var e,t=pt;t;)(e=Ce-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ge}()}finally{Ge=0,function Ps(){for(var t,n,e=pt,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:pt=n);Ye=t,Ut(r)}(),Ce=0}}function As(){var t=Ze.now(),e=t-gt;e>1e3&&(_t-=e,gt=t)}function Ut(t){Ge||(We&&(We=clearTimeout(We)),t-Ce>24?(t<1/0&&(We=setTimeout(On,t-Ze.now()-_t)),Ke&&(Ke=clearInterval(Ke))):(Ke||(gt=Ze.now(),Ke=setInterval(As,1e3)),Ge=1,Mn(On)))}mt.prototype=Vt.prototype={constructor:mt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ht():+n)+(null==e?0:+e),!this._next&&Ye!==this&&(Ye?Ye._next=this:pt=this,Ye=this),this._call=t,this._time=n,Ut()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ut())}};const jn=4294967296;function Ms(t){return t.x}function Os(t){return t.y}var Gs=Math.PI*(3-Math.sqrt(5));function $s(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,a=.6,o=new Map,l=Vt(f),u=ct("tick","end"),c=function Ls(){let t=1;return()=>(t=(1664525*t+1013904223)%jn)/jn}();function f(){h(),u.call("tick",e),n<r&&(l.stop(),u.call("end",e))}function h(m){var y,R,_=t.length;void 0===m&&(m=1);for(var C=0;C<m;++C)for(n+=(s-n)*i,o.forEach(function(g){g(n)}),y=0;y<_;++y)null==(R=t[y]).fx?R.x+=R.vx*=a:(R.x=R.fx,R.vx=0),null==R.fy?R.y+=R.vy*=a:(R.y=R.fy,R.vy=0);return e}function d(){for(var _,m=0,y=t.length;m<y;++m){if((_=t[m]).index=m,null!=_.fx&&(_.x=_.fx),null!=_.fy&&(_.y=_.fy),isNaN(_.x)||isNaN(_.y)){var R=10*Math.sqrt(.5+m),C=m*Gs;_.x=R*Math.cos(C),_.y=R*Math.sin(C)}(isNaN(_.vx)||isNaN(_.vy))&&(_.vx=_.vy=0)}}function x(m){return m.initialize&&m.initialize(t,c),m}return null==t&&(t=[]),d(),e={tick:h,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(m){return arguments.length?(t=m,d(),o.forEach(x),e):t},alpha:function(m){return arguments.length?(n=+m,e):n},alphaMin:function(m){return arguments.length?(r=+m,e):r},alphaDecay:function(m){return arguments.length?(i=+m,e):+i},alphaTarget:function(m){return arguments.length?(s=+m,e):s},velocityDecay:function(m){return arguments.length?(a=1-m,e):1-a},randomSource:function(m){return arguments.length?(c=m,o.forEach(x),e):c},force:function(m,y){return arguments.length>1?(null==y?o.delete(m):o.set(m,x(y)),e):o.get(m)},find:function(m,y,_){var g,k,F,z,M,R=0,C=t.length;for(null==_?_=1/0:_*=_,R=0;R<C;++R)(F=(g=m-(z=t[R]).x)*g+(k=y-z.y)*k)<_&&(M=z,_=F);return M},on:function(m,y){return arguments.length>1?(u.on(m,y),e):u.on(m)}}}function Gn(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,f,h,d,x,m,y,_,R,s=t._root,a={data:r},o=t._x0,l=t._y0,u=t._x1,c=t._y1;if(!s)return t._root=a,t;for(;s.length;)if((m=e>=(f=(o+u)/2))?o=f:u=f,(y=n>=(h=(l+c)/2))?l=h:c=h,i=s,!(s=s[_=y<<1|m]))return i[_]=a,t;if(d=+t._x.call(null,s.data),x=+t._y.call(null,s.data),e===d&&n===x)return a.next=s,i?i[_]=a:t._root=a,t;do{i=i?i[_]=new Array(4):t._root=new Array(4),(m=e>=(f=(o+u)/2))?o=f:u=f,(y=n>=(h=(l+c)/2))?l=h:c=h}while((_=y<<1|m)==(R=(x>=h)<<1|d>=f));return i[R]=s,i[_]=a,t}function W(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function ta(t){return t[0]}function ra(t){return t[1]}function Xt(t,e,n){var r=new Wt(null==e?ta:e,null==n?ra:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Wt(t,e,n,r,i,s){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function $n(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var K=Xt.prototype=Wt.prototype;function Ie(t){return function(){return t}}function Re(t){return 1e-6*(t()-.5)}function oa(t){return t.x+t.vx}function ua(t){return t.y+t.vy}function ca(t){return t.index}function Bn(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}K.copy=function(){var n,r,t=new Wt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root;if(!e)return t;if(!e.length)return t._root=$n(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=$n(r));return t},K.add=function Bs(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Gn(this.cover(e,n),e,n,t)},K.addAll=function Qs(t){var e,n,i,s,r=t.length,a=new Array(r),o=new Array(r),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(a[n]=i,o[n]=s,i<l&&(l=i),i>c&&(c=i),s<u&&(u=s),s>f&&(f=s));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<r;++n)Gn(this,a[n],o[n],t[n]);return this},K.cover=function Hs(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,s=(r=Math.floor(e))+1;else{for(var l,u,a=i-n||1,o=this._root;n>t||t>=i||r>e||e>=s;)switch(u=(e<r)<<1|t<n,l=new Array(4),l[u]=o,o=l,a*=2,u){case 0:i=n+a,s=r+a;break;case 1:n=i-a,s=r+a;break;case 2:i=n+a,r=s-a;break;case 3:n=i-a,r=s-a}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this},K.data=function Vs(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},K.extent=function Us(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},K.find=function Xs(t,e,n){var r,a,o,l,u,x,m,i=this._x0,s=this._y0,c=this._x1,f=this._y1,h=[],d=this._root;for(d&&h.push(new W(d,i,s,c,f)),null==n?n=1/0:(i=t-n,s=e-n,c=t+n,f=e+n,n*=n);x=h.pop();)if(!(!(d=x.node)||(a=x.x0)>c||(o=x.y0)>f||(l=x.x1)<i||(u=x.y1)<s))if(d.length){var y=(a+l)/2,_=(o+u)/2;h.push(new W(d[3],y,_,l,u),new W(d[2],a,_,y,u),new W(d[1],y,o,l,_),new W(d[0],a,o,y,_)),(m=(e>=_)<<1|t>=y)&&(x=h[h.length-1],h[h.length-1]=h[h.length-1-m],h[h.length-1-m]=x)}else{var R=t-+this._x.call(null,d.data),C=e-+this._y.call(null,d.data),g=R*R+C*C;if(g<n){var k=Math.sqrt(n=g);i=t-k,s=e-k,c=t+k,f=e+k,r=d.data}}return r},K.remove=function Ws(t){if(isNaN(c=+this._x.call(null,t))||isNaN(f=+this._y.call(null,t)))return this;var e,r,i,s,c,f,h,d,x,m,y,_,n=this._root,a=this._x0,o=this._y0,l=this._x1,u=this._y1;if(!n)return this;if(n.length)for(;;){if((x=c>=(h=(a+l)/2))?a=h:l=h,(m=f>=(d=(o+u)/2))?o=d:u=d,e=n,!(n=n[y=m<<1|x]))return this;if(!n.length)break;(e[y+1&3]||e[y+2&3]||e[y+3&3])&&(r=e,_=y)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):e?(s?e[y]=s:delete e[y],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[_]=n:this._root=n),this):(this._root=s,this)},K.removeAll=function Ks(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},K.root=function Ys(){return this._root},K.size=function Zs(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},K.visit=function Js(t){var n,i,s,a,o,l,e=[],r=this._root;for(r&&e.push(new W(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,s=n.x0,a=n.y0,o=n.x1,l=n.y1)&&r.length){var u=(s+o)/2,c=(a+l)/2;(i=r[3])&&e.push(new W(i,u,c,o,l)),(i=r[2])&&e.push(new W(i,s,c,u,l)),(i=r[1])&&e.push(new W(i,u,a,o,c)),(i=r[0])&&e.push(new W(i,s,a,u,c))}return this},K.visitAfter=function ea(t){var r,e=[],n=[];for(this._root&&e.push(new W(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var s,a=r.x0,o=r.y0,l=r.x1,u=r.y1,c=(a+l)/2,f=(o+u)/2;(s=i[0])&&e.push(new W(s,a,o,c,f)),(s=i[1])&&e.push(new W(s,c,o,l,f)),(s=i[2])&&e.push(new W(s,a,f,c,u)),(s=i[3])&&e.push(new W(s,c,f,l,u))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this},K.x=function na(t){return arguments.length?(this._x=t,this):this._x},K.y=function ia(t){return arguments.length?(this._y=t,this):this._y};function Qn(t){return((t=Math.exp(t))+1/t)/2}const _a=function t(e,n,r){function i(s,a){var y,_,o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],h=a[2],d=c-o,x=f-l,m=d*d+x*x;if(m<1e-12)_=Math.log(h/u)/e,y=function(z){return[o+z*d,l+z*x,u*Math.exp(e*z*_)]};else{var R=Math.sqrt(m),C=(h*h-u*u+r*m)/(2*u*n*R),g=(h*h-u*u-r*m)/(2*h*n*R),k=Math.log(Math.sqrt(C*C+1)-C),F=Math.log(Math.sqrt(g*g+1)-g);_=(F-k)/e,y=function(z){var M=z*_,B=Qn(k),j=u/(n*R)*(B*function ga(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*M+k)-function pa(t){return((t=Math.exp(t))-1/t)/2}(k));return[o+j*d,l+j*x,u*B/Qn(e*M+k)]}}return y.duration=1e3*_*e/Math.SQRT2,y}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a;return t(a,o,o*o)},i}(Math.SQRT2,2,4);function Hn(t,e,n){var r=new mt;return e=null==e?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var ma=ct("start","end","cancel","interrupt"),ya=[];function bt(t,e,n,r,i,s){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function xa(t,e,n){var i,r=t.__transition;function s(u){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var c,f,h,d;if(1!==n.state)return l();for(c in r)if((d=r[c]).name===n.name){if(3===d.state)return Hn(a);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Hn(function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(u))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=d);i.length=f+1}}function o(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=5,1),f=-1,h=i.length;++f<h;)i[f].call(t,c);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var u in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Vt(s,0,n.time)}(t,n,{name:e,index:r,group:i,on:ma,tween:ya,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function Zt(t,e){var n=re(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function le(t,e){var n=re(t,e);if(n.state>3)throw new Error("too late; already running");return n}function re(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function vt(t,e){var r,i,a,n=t.__transition,s=!0;if(n){for(a in e=null==e?null:e+"",n)(r=n[a]).name===e?(i=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]):s=!1;s&&delete t.__transition}}function Se(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var wt,Wn=180/Math.PI,Jt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Kn(t,e,n,r,i,s){var a,o,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*Wn,skewX:Math.atan(l)*Wn,scaleX:a,scaleY:o}}function Yn(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}return function(u,c){var f=[],h=[];return u=t(u),c=t(c),function s(u,c,f,h,d,x){if(u!==f||c!==h){var m=d.push("translate(",null,e,null,n);x.push({i:m-4,x:Se(u,f)},{i:m-2,x:Se(c,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}(u.translateX,u.translateY,c.translateX,c.translateY,f,h),function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Se(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}(u.rotate,c.rotate,f,h),function o(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Se(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}(u.skewX,c.skewX,f,h),function l(u,c,f,h,d,x){if(u!==f||c!==h){var m=d.push(i(d)+"scale(",null,",",null,")");x.push({i:m-4,x:Se(u,f)},{i:m-2,x:Se(c,h)})}else(1!==f||1!==h)&&d.push(i(d)+"scale("+f+","+h+")")}(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var y,x=-1,m=h.length;++x<m;)f[(y=h[x]).i]=y.x(d);return f.join("")}}}var Ra=Yn(function va(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Jt:Kn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),Sa=Yn(function wa(t){return null!=t&&(wt||(wt=document.createElementNS("http://www.w3.org/2000/svg","g")),wt.setAttribute("transform",t),t=wt.transform.baseVal.consolidate())?Kn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Jt},", ",")",")");function Na(t,e){var n,r;return function(){var i=le(this,t),s=i.tween;if(s!==n)for(var a=0,o=(r=n=s).length;a<o;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function Ta(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var s=le(this,t),a=s.tween;if(a!==r){i=(r=a).slice();for(var o={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=o;break}l===u&&i.push(o)}s.tween=i}}function en(t,e,n){var r=t._id;return t.each(function(){var i=le(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return re(i,r).value[e]}}function tn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Zn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Je(){}var Rt=1/.7,$e="\\s*([+-]?\\d+)\\s*",tt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ce="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ca=/^#([0-9a-f]{3,8})$/,Ia=new RegExp("^rgb\\("+[$e,$e,$e]+"\\)$"),Ea=new RegExp("^rgb\\("+[ce,ce,ce]+"\\)$"),Fa=new RegExp("^rgba\\("+[$e,$e,$e,tt]+"\\)$"),qa=new RegExp("^rgba\\("+[ce,ce,ce,tt]+"\\)$"),Aa=new RegExp("^hsl\\("+[tt,ce,ce]+"\\)$"),Pa=new RegExp("^hsla\\("+[tt,ce,ce,tt]+"\\)$"),Jn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function er(){return this.rgb().formatHex()}function tr(){return this.rgb().formatRgb()}function nt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ca.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?nr(e):3===n?new J(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?St(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?St(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ia.exec(t))?new J(e[1],e[2],e[3],1):(e=Ea.exec(t))?new J(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Fa.exec(t))?St(e[1],e[2],e[3],e[4]):(e=qa.exec(t))?St(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Aa.exec(t))?sr(e[1],e[2]/100,e[3]/100,1):(e=Pa.exec(t))?sr(e[1],e[2]/100,e[3]/100,e[4]):Jn.hasOwnProperty(t)?nr(Jn[t]):"transparent"===t?new J(NaN,NaN,NaN,0):null}function nr(t){return new J(t>>16&255,t>>8&255,255&t,1)}function St(t,e,n,r){return r<=0&&(t=e=n=NaN),new J(t,e,n,r)}function Da(t){return t instanceof Je||(t=nt(t)),t?new J((t=t.rgb()).r,t.g,t.b,t.opacity):new J}function Nt(t,e,n,r){return 1===arguments.length?Da(t):new J(t,e,n,null==r?1:r)}function J(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function rr(){return"#"+nn(this.r)+nn(this.g)+nn(this.b)}function ir(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function nn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function sr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new he(t,e,n,r)}function ar(t){if(t instanceof he)return new he(t.h,t.s,t.l,t.opacity);if(t instanceof Je||(t=nt(t)),!t)return new he;if(t instanceof he)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(a=e===s?(n-r)/o+6*(n<r):n===s?(r-e)/o+2:(e-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new he(a,o,l,t.opacity)}function he(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function rn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function or(t,e,n,r,i){var s=t*t,a=s*t;return((1-3*t+3*s-a)*e+(4-6*s+3*a)*n+(1+3*t+3*s-3*a)*r+a*i)/6}tn(Je,nt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:er,formatHex:er,formatHsl:function za(){return ar(this).formatHsl()},formatRgb:tr,toString:tr}),tn(J,Nt,Zn(Je,{brighter:function(t){return t=null==t?Rt:Math.pow(Rt,t),new J(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new J(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rr,formatHex:rr,formatRgb:ir,toString:ir})),tn(he,function La(t,e,n,r){return 1===arguments.length?ar(t):new he(t,e,n,null==r?1:r)},Zn(Je,{brighter:function(t){return t=null==t?Rt:Math.pow(Rt,t),new he(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new he(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new J(rn(t>=240?t-240:t+120,i,r),rn(t,i,r),rn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const ur=t=>()=>t;function lr(t,e){return function(n){return t+n*e}}function Ga(t){return 1==(t=+t)?cr:function(e,n){return n-e?function ja(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):ur(isNaN(e)?n:e)}}function cr(t,e){var n=e-t;return n?lr(t,n):ur(isNaN(t)?e:t)}const hr=function t(e){var n=Ga(e);function r(i,s){var a=n((i=Nt(i)).r,(s=Nt(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=cr(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=t,r}(1);function fr(t){return function(e){var a,o,n=e.length,r=new Array(n),i=new Array(n),s=new Array(n);for(a=0;a<n;++a)o=Nt(e[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=t(r),i=t(i),s=t(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}fr(function Ma(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],a=r>0?t[r-1]:2*i-s,o=r<e-1?t[r+2]:2*s-i;return or((n-r/e)*e,a,i,s,o)}}),fr(function Oa(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],s=t[r%e],a=t[(r+1)%e],o=t[(r+2)%e];return or((n-r/e)*e,i,s,a,o)}});var sn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,an=new RegExp(sn.source,"g");function Qa(t,e){var r,i,s,n=sn.lastIndex=an.lastIndex=0,a=-1,o=[],l=[];for(t+="",e+="";(r=sn.exec(t))&&(i=an.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:Se(r,i)})),n=an.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?function Ba(t){return function(e){return t(e)+""}}(l[0].x):function $a(t){return function(){return t}}(e):(e=l.length,function(u){for(var f,c=0;c<e;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function dr(t,e){var n;return("number"==typeof e?Se:e instanceof nt?hr:(n=nt(e))?(e=n,hr):Qa)(t,e)}function Ha(t){return function(){this.removeAttribute(t)}}function Va(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ua(t,e,n){var r,s,i=n+"";return function(){var a=this.getAttribute(t);return a===i?null:a===r?s:s=e(r=a,n)}}function Xa(t,e,n){var r,s,i=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?s:s=e(r=a,n)}}function Wa(t,e,n){var r,i,s;return function(){var a,l,o=n(this);return null==o?void this.removeAttribute(t):(a=this.getAttribute(t))===(l=o+"")?null:a===r&&l===i?s:(i=l,s=e(r=a,o))}}function Ka(t,e,n){var r,i,s;return function(){var a,l,o=n(this);return null==o?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local))===(l=o+"")?null:a===r&&l===i?s:(i=l,s=e(r=a,o))}}function Za(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ja(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function eo(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Ja(t,s)),n}return i._value=e,i}function to(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Za(t,s)),n}return i._value=e,i}function ro(t,e){return function(){Zt(this,t).delay=+e.apply(this,arguments)}}function io(t,e){return e=+e,function(){Zt(this,t).delay=e}}function ao(t,e){return function(){le(this,t).duration=+e.apply(this,arguments)}}function oo(t,e){return e=+e,function(){le(this,t).duration=e}}function lo(t,e){if("function"!=typeof e)throw new Error;return function(){le(this,t).ease=e}}function mo(t,e,n){var r,i,s=function _o(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||"start"===e})}(e)?Zt:le;return function(){var a=s(this,t),o=a.on;o!==r&&(i=(r=o).copy()).on(e,n),a.on=i}}var Ro=Ue.prototype.constructor;function pr(t){return function(){this.style.removeProperty(t)}}function Eo(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Fo(t,e,n){var r,i;function s(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&Eo(t,a,n)),r}return s._value=e,s}function Do(t){return function(e){this.textContent=t.call(this,e)}}function Lo(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Do(i)),e}return r._value=t,r}var Go=0;function ge(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function gr(){return++Go}var _e=Ue.prototype;ge.prototype=function $o(t){return Ue().transition(t)}.prototype={constructor:ge,select:function vo(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Ot(t));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var c,f,o=r[a],l=o.length,u=s[a]=new Array(l),h=0;h<l;++h)(c=o[h])&&(f=t.call(c,c.__data__,h,o))&&("__data__"in c&&(f.__data__=c.__data__),u[h]=f,bt(u[h],e,n,h,u,re(c,n)));return new ge(s,this._parents,e,n)},selectAll:function wo(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=wn(t));for(var r=this._groups,i=r.length,s=[],a=[],o=0;o<i;++o)for(var c,l=r[o],u=l.length,f=0;f<u;++f)if(c=l[f]){for(var d,h=t.call(c,c.__data__,f,l),x=re(c,n),m=0,y=h.length;m<y;++m)(d=h[m])&&bt(d,e,n,m,h,x);s.push(h),a.push(c)}return new ge(s,a,e,n)},selectChild:_e.selectChild,selectChildren:_e.selectChildren,filter:function po(t){"function"!=typeof t&&(t=Rn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var l,s=e[i],a=s.length,o=r[i]=[],u=0;u<a;++u)(l=s[u])&&t.call(l,l.__data__,u,s)&&o.push(l);return new ge(r,this._parents,this._name,this._id)},merge:function go(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var h,l=e[o],u=n[o],c=l.length,f=a[o]=new Array(c),d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;o<r;++o)a[o]=e[o];return new ge(a,this._parents,this._name,this._id)},selection:function So(){return new Ro(this._groups,this._parents)},transition:function Oo(){for(var t=this._name,e=this._id,n=gr(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l,a=r[s],o=a.length,u=0;u<o;++u)if(l=a[u]){var c=re(l,e);bt(l,t,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ge(r,this._parents,t,n)},call:_e.call,nodes:_e.nodes,node:_e.node,size:_e.size,empty:_e.empty,each:_e.each,on:function yo(t,e){var n=this._id;return arguments.length<2?re(this.node(),n).on.on(t):this.each(mo(n,t,e))},attr:function Ya(t,e){var n=ft(t),r="transform"===n?Sa:dr;return this.attrTween(t,"function"==typeof e?(n.local?Ka:Wa)(n,r,en(this,"attr."+t,e)):null==e?(n.local?Va:Ha)(n):(n.local?Xa:Ua)(n,r,e))},attrTween:function no(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=ft(t);return this.tween(n,(r.local?eo:to)(r,e))},style:function Io(t,e,n){var r="transform"==(t+="")?Ra:dr;return null==e?this.styleTween(t,function No(t,e){var n,r,i;return function(){var s=Oe(this,t),a=(this.style.removeProperty(t),Oe(this,t));return s===a?null:s===n&&a===r?i:i=e(n=s,r=a)}}(t,r)).on("end.style."+t,pr(t)):"function"==typeof e?this.styleTween(t,function ko(t,e,n){var r,i,s;return function(){var a=Oe(this,t),o=n(this),l=o+"";return null==o&&(this.style.removeProperty(t),l=o=Oe(this,t)),a===l?null:a===r&&l===i?s:(i=l,s=e(r=a,o))}}(t,r,en(this,"style."+t,e))).each(function Co(t,e){var n,r,i,o,s="style."+e,a="end."+s;return function(){var l=le(this,t),u=l.on,c=null==l.value[s]?o||(o=pr(e)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(a,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function To(t,e,n){var r,s,i=n+"";return function(){var a=Oe(this,t);return a===i?null:a===r?s:s=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function qo(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Fo(t,e,null==n?"":n))},text:function zo(t){return this.tween("text","function"==typeof t?function Po(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(en(this,"text",t)):function Ao(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Mo(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Lo(t))},remove:function bo(){return this.on("end.remove",function xo(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function ka(t,e){var n=this._id;if(t+="",arguments.length<2){for(var a,r=re(this.node(),n).tween,i=0,s=r.length;i<s;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((null==e?Na:Ta)(n,t,e))},delay:function so(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ro:io)(e,t)):re(this.node(),e).delay},duration:function uo(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ao:oo)(e,t)):re(this.node(),e).duration},ease:function co(t){var e=this._id;return arguments.length?this.each(lo(e,t)):re(this.node(),e).ease},easeVarying:function fo(t){if("function"!=typeof t)throw new Error;return this.each(function ho(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;le(this,t).ease=n}}(this._id,t))},end:function jo(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,a){var o={value:a},l={value:function(){0==--i&&s()}};n.each(function(){var u=le(this,r),c=u.on;c!==t&&((e=(t=c).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),u.on=e}),0===i&&s()})},[Symbol.iterator]:_e[Symbol.iterator]};var Qo={time:null,delay:0,duration:250,ease:function Bo(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ho(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Ue.prototype.interrupt=function ba(t){return this.each(function(){vt(this,t)})},Ue.prototype.transition=function Vo(t){var e,n;t instanceof ge?(e=t._id,t=t._name):(e=gr(),(n=Qo).time=Ht(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l,a=r[s],o=a.length,u=0;u<o;++u)(l=a[u])&&bt(l,t,e,u,a,n||Ho(l,e));return new ge(r,this._parents,t,e)};const Tt=t=>()=>t;function Uo(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function me(t,e,n){this.k=t,this.x=e,this.y=n}me.prototype={constructor:me,scale:function(t){return 1===t?this:new me(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new me(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var on=new me(1,0,0);function un(t){t.stopImmediatePropagation()}function rt(t){t.preventDefault(),t.stopImmediatePropagation()}function Wo(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Ko(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function _r(){return this.__zoom||on}function Yo(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Zo(){return navigator.maxTouchPoints||"ontouchstart"in this}function Jo(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a))}(function Xo(t){for(;!t.__zoom;)if(!(t=t.parentNode))return on;return t.__zoom}).prototype=me.prototype;const kt_LINK_DISTANCE=10,kt_COLLISION_STRENGTH=1,kt_COLLISION_RADIUS=30,kt_CHARGE_STRENGTH=-10;let it=class{constructor(e,n){this.graphVisualizerService=e,this.prefixPipe=n,this.clickedNodeRequest=new w.vpe,this.faCompressArrowsAlt=te.udn,this.limitValues=[5,10,25,50,100,250,500,1e3],this.limit=50,this.sliderConfig={initial:1,min:.1,max:3,step:.01,value:1},this._resize$=new ve.x,this._destroyed$=new ve.x}onResize(){!this._graphContainer||!this.queryResultTriples||(this._divWidth=this._getContainerWidth(this._graphContainer),this._divHeight=this._getContainerHeight(this._graphContainer),this._resize$.next(!0))}ngOnInit(){this._resize$.pipe((0,Pe.b)(150),(0,we.R)(this._destroyed$)).subscribe(e=>{this._redraw()}),this._redraw()}ngOnChanges(e){e.queryResultTriples&&e.queryResultTriples.currentValue&&!e.queryResultTriples.isFirstChange()&&(this.queryResultTriples=e.queryResultTriples.currentValue,this._redraw())}onLimitValueChange(e){this.limit=e,this._redraw()}onReCenter(){!this._svg||!this._divWidth||!this._divHeight||(this.onZoomChange(this.sliderConfig.initial),this._zoomBehaviour.translateTo(this._svg,this._divWidth/2,this._divHeight/2))}onZoomChange(e){this.sliderConfig.value=e,this._reScaleZoom()}log(e,n){const r=n&&JSON.parse(JSON.stringify(n));console.info(e,r)}ngOnDestroy(){this._destroyed$.next(!0),this._destroyed$.complete()}_redraw(){this.queryResultTriples&&(this._cleanSVG(),this._createSVG(),this._attachData(),this._reScaleZoom())}_cleanSVG(){(function fa(t){return"string"==typeof t?new X([document.querySelectorAll(t)],[document.documentElement]):new X([vn(t)],$t)})("svg.force-graph > *").remove()}_createSVG(){!this._graphContainer||(this._divWidth=this._divWidth?this._divWidth:this._getContainerWidth(this._graphContainer)?this._getContainerWidth(this._graphContainer):400,this._divHeight=this.height?this.height:this._getContainerHeight(this._graphContainer)?this._getContainerHeight(this._graphContainer):500,this._divHeight=this._divHeight-20,this._svg||(this._svg=ue(this._graphContainer.nativeElement).append("svg").attr("class","force-graph")),this._svg.attr("width",this._divWidth).attr("height",this._divHeight),this._zoomGroup=this._svg.append("g").attr("class","zoom-container"))}_attachData(){const e=this.graphVisualizerService.limitTriples(this.queryResultTriples,this.limit);"string"==typeof e?this.graphVisualizerService.parseTripleString(e).then(n=>{const r=this.graphVisualizerService.abbreviateTriples(n.triples,n.namespaces);this._simulationData=this._triplesToD3GraphData(r),this._setupForceSimulation(),this._updateSVG()}):(this._simulationData=this._triplesToD3GraphData(e),this._setupForceSimulation(),this._updateSVG())}_setupForceSimulation(){this._forceSimulation=$s();const e=function sa(){var t,e,n,r,s,i=Ie(-30),a=1,o=1/0,l=.81;function u(d){var x,m=t.length,y=Xt(t,Ms,Os).visitAfter(f);for(r=d,x=0;x<m;++x)e=t[x],y.visit(h)}function c(){if(t){var d,m,x=t.length;for(s=new Array(x),d=0;d<x;++d)m=t[d],s[m.index]=+i(m,d,t)}}function f(d){var m,y,R,C,g,x=0,_=0;if(d.length){for(R=C=g=0;g<4;++g)(m=d[g])&&(y=Math.abs(m.value))&&(x+=m.value,_+=y,R+=y*m.x,C+=y*m.y);d.x=R/_,d.y=C/_}else{(m=d).x=m.data.x,m.y=m.data.y;do{x+=s[m.data.index]}while(m=m.next)}d.value=x}function h(d,x,m,y){if(!d.value)return!0;var _=d.x-e.x,R=d.y-e.y,C=y-x,g=_*_+R*R;if(C*C/l<g)return g<o&&(0===_&&(g+=(_=Re(n))*_),0===R&&(g+=(R=Re(n))*R),g<a&&(g=Math.sqrt(a*g)),e.vx+=_*d.value*r/g,e.vy+=R*d.value*r/g),!0;if(!(d.length||g>=o)){(d.data!==e||d.next)&&(0===_&&(g+=(_=Re(n))*_),0===R&&(g+=(R=Re(n))*R),g<a&&(g=Math.sqrt(a*g)));do{d.data!==e&&(C=s[d.data.index]*r/g,e.vx+=_*C,e.vy+=R*C)}while(d=d.next)}}return u.initialize=function(d,x){t=d,n=x,c()},u.strength=function(d){return arguments.length?(i="function"==typeof d?d:Ie(+d),c(),u):i},u.distanceMin=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.distanceMax=function(d){return arguments.length?(o=d*d,u):Math.sqrt(o)},u.theta=function(d){return arguments.length?(l=d*d,u):Math.sqrt(l)},u}().strength(s=>this._nodeRadius(s)*kt_CHARGE_STRENGTH),n=function aa(t,e){var n,r=1;function i(){var s,o,a=n.length,l=0,u=0;for(s=0;s<a;++s)l+=(o=n[s]).x,u+=o.y;for(l=(l/a-t)*r,u=(u/a-e)*r,s=0;s<a;++s)(o=n[s]).x-=l,o.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(t=+s,i):t},i.y=function(s){return arguments.length?(e=+s,i):e},i.strength=function(s){return arguments.length?(r=+s,i):r},i}(this._divWidth/2,this._divHeight/2),r=function la(t){var e,n,r,i=1,s=1;function a(){for(var u,f,h,d,x,m,y,c=e.length,_=0;_<s;++_)for(f=Xt(e,oa,ua).visitAfter(o),u=0;u<c;++u)h=e[u],m=n[h.index],y=m*m,d=h.x+h.vx,x=h.y+h.vy,f.visit(R);function R(C,g,k,F,z){var M=C.data,B=C.r,j=m+B;if(!M)return g>d+j||F<d-j||k>x+j||z<x-j;if(M.index>h.index){var Q=d-M.x-M.vx,ee=x-M.y-M.vy,Z=Q*Q+ee*ee;Z<j*j&&(0===Q&&(Z+=(Q=Re(r))*Q),0===ee&&(Z+=(ee=Re(r))*ee),Z=(j-(Z=Math.sqrt(Z)))/Z*i,h.vx+=(Q*=Z)*(j=(B*=B)/(y+B)),h.vy+=(ee*=Z)*j,M.vx-=Q*(j=1-j),M.vy-=ee*j)}}}function o(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(e){var u,f,c=e.length;for(n=new Array(c),u=0;u<c;++u)f=e[u],n[f.index]=+t(f,u,e)}}return"function"!=typeof t&&(t=Ie(null==t?1:+t)),a.initialize=function(u,c){e=u,r=c,l()},a.iterations=function(u){return arguments.length?(s=+u,a):s},a.strength=function(u){return arguments.length?(i=+u,a):i},a.radius=function(u){return arguments.length?(t="function"==typeof u?u:Ie(+u),l(),a):t},a}().strength(kt_COLLISION_STRENGTH).radius(kt_COLLISION_RADIUS).iterations(2),i=function ha(t){var r,s,a,o,l,u,e=ca,n=function f(y){return 1/Math.min(o[y.source.index],o[y.target.index])},i=Ie(30),c=1;function h(y){for(var _=0,R=t.length;_<c;++_)for(var g,k,F,z,M,B,j,C=0;C<R;++C)k=(g=t[C]).source,z=(F=g.target).x+F.vx-k.x-k.vx||Re(u),M=F.y+F.vy-k.y-k.vy||Re(u),z*=B=((B=Math.sqrt(z*z+M*M))-s[C])/B*y*r[C],M*=B,F.vx-=z*(j=l[C]),F.vy-=M*j,k.vx+=z*(j=1-j),k.vy+=M*j}function d(){if(a){var y,g,_=a.length,R=t.length,C=new Map(a.map((k,F)=>[e(k,F,a),k]));for(y=0,o=new Array(_);y<R;++y)(g=t[y]).index=y,"object"!=typeof g.source&&(g.source=Bn(C,g.source)),"object"!=typeof g.target&&(g.target=Bn(C,g.target)),o[g.source.index]=(o[g.source.index]||0)+1,o[g.target.index]=(o[g.target.index]||0)+1;for(y=0,l=new Array(R);y<R;++y)g=t[y],l[y]=o[g.source.index]/(o[g.source.index]+o[g.target.index]);r=new Array(R),x(),s=new Array(R),m()}}function x(){if(a)for(var y=0,_=t.length;y<_;++y)r[y]=+n(t[y],y,t)}function m(){if(a)for(var y=0,_=t.length;y<_;++y)s[y]=+i(t[y],y,t)}return null==t&&(t=[]),h.initialize=function(y,_){a=y,u=_,d()},h.links=function(y){return arguments.length?(t=y,d(),h):t},h.id=function(y){return arguments.length?(e=y,h):e},h.iterations=function(y){return arguments.length?(c=+y,h):c},h.strength=function(y){return arguments.length?(n="function"==typeof y?y:Ie(+y),x(),h):n},h.distance=function(y){return arguments.length?(i="function"==typeof y?y:Ie(+y),m(),h):i},h}().links(this._simulationData.links).id(s=>s.predicate).distance(kt_LINK_DISTANCE);this._forceSimulation.force("charge_force",e).force("center_force",n).force("collide_force",r),this._forceSimulation.nodes(this._simulationData.nodes),this._forceSimulation.force("links",i),this._forceSimulation.alpha(1).restart()}_updateSVG(){if(!this._svg)return;this._zoomGroup.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",30).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:polyline").attr("points","0,-5 10,0 0,5");const e=this._zoomGroup.append("g").attr("class","links").selectAll(".link").data(this._simulationData.nodeTriples).enter().append("path").attr("marker-end","url(#end)").attr("class","link"),n=this._zoomGroup.append("g").attr("class","link-texts").selectAll(".link-text").data(this._simulationData.nodeTriples).enter().append("text").attr("class","link-text").text(s=>s.nodePredicate.label),r=this._zoomGroup.append("g").attr("class","node-texts").selectAll(".node-text").data(this._filterNodesByType(this._simulationData.nodes,O.node)).enter().append("text").attr("class","node-text").text(s=>s.label),i=this._zoomGroup.append("g").attr("class","nodes").selectAll(".node").data(this._filterNodesByType(this._simulationData.nodes,O.node)).enter().append("circle").attr("class",s=>s.owlClass?"class":-1!==s.label.indexOf("_:")?"blank":s.instance||-1!==s.label.indexOf("inst:")?"instance":"node").attr("id",s=>s.label).attr("r",s=>-1!==s.label.indexOf("_:")?8:s.instance||-1!==s.label.indexOf("inst:")?11:s.owlClass||-1!==s.label.indexOf("inst:")?10:9).on("click",(s,a)=>{this._clickedOnNode(s,a)});this._forceSimulation.on("tick",()=>{this._updateNodePositions(i),this._updateNodeTextPositions(r),this._updateLinkPositions(e),this._updateLinkTextPositions(n)}),this._dragHandler(i,this._forceSimulation),this._zoomHandler(this._zoomGroup,this._svg)}_reScaleZoom(){!this._svg||!this.sliderConfig.value||this._zoomBehaviour.scaleTo(this._svg,this.sliderConfig.value)}_checkForRdfType(e){return"a"===e.label||"rdf:type"===e.label||e.label===this.prefixPipe.transform("rdf:type",ne.long)}_clickedOnNode(e,n){e.defaultPrevented||this.clickedNodeRequest.emit(n)}_dragHandler(e,n){const a=function Es(){var o,l,u,c,t=Ts,e=ks,n=Cs,r=Is,i={},s=ct("start","drag","end"),a=0,f=0;function h(g){g.on("mousedown.drag",d).filter(r).on("touchstart.drag",y).on("touchmove.drag",_,Ns).on("touchend.drag touchcancel.drag",R).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(g,k){if(!c&&t.call(this,g,k)){var F=C(this,e.call(this,g,k),g,k,"mouse");!F||(ue(g.view).on("mousemove.drag",x,Xe).on("mouseup.drag",m,Xe),zn(g.view),Bt(g),u=!1,o=g.clientX,l=g.clientY,F("start",g))}}function x(g){if(je(g),!u){var k=g.clientX-o,F=g.clientY-l;u=k*k+F*F>f}i.mouse("drag",g)}function m(g){ue(g.view).on("mousemove.drag mouseup.drag",null),Dn(g.view,u),je(g),i.mouse("end",g)}function y(g,k){if(t.call(this,g,k)){var B,j,F=g.changedTouches,z=e.call(this,g,k),M=F.length;for(B=0;B<M;++B)(j=C(this,z,g,k,F[B].identifier,F[B]))&&(Bt(g),j("start",g,F[B]))}}function _(g){var z,M,k=g.changedTouches,F=k.length;for(z=0;z<F;++z)(M=i[k[z].identifier])&&(je(g),M("drag",g,k[z]))}function R(g){var z,M,k=g.changedTouches,F=k.length;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),z=0;z<F;++z)(M=i[k[z].identifier])&&(Bt(g),M("end",g,k[z]))}function C(g,k,F,z,M,B){var ee,Z,p,j=s.copy(),Q=pe(B||F,k);if(null!=(p=n.call(g,new Qt("beforestart",{sourceEvent:F,target:h,identifier:M,active:a,x:Q[0],y:Q[1],dx:0,dy:0,dispatch:j}),z)))return ee=p.x-Q[0]||0,Z=p.y-Q[1]||0,function N(b,T,P){var L,D=Q;switch(b){case"start":i[M]=N,L=a++;break;case"end":delete i[M],--a;case"drag":Q=pe(P||T,k),L=a}j.call(b,g,new Qt(b,{sourceEvent:T,subject:p,target:h,identifier:M,active:L,x:Q[0]+ee,y:Q[1]+Z,dx:Q[0]-D[0],dy:Q[1]-D[1],dispatch:j}),z)}}return h.filter=function(g){return arguments.length?(t="function"==typeof g?g:dt(!!g),h):t},h.container=function(g){return arguments.length?(e="function"==typeof g?g:dt(g),h):e},h.subject=function(g){return arguments.length?(n="function"==typeof g?g:dt(g),h):n},h.touchable=function(g){return arguments.length?(r="function"==typeof g?g:dt(!!g),h):r},h.on=function(){var g=s.on.apply(s,arguments);return g===s?h:g},h.clickDistance=function(g){return arguments.length?(f=(g=+g)*g,h):Math.sqrt(f)},h}().on("start",(o,l)=>{o.sourceEvent.stopPropagation(),o.active||n.alphaTarget(.3).restart(),l.fx=l.x,l.fy=l.y}).on("drag",(o,l)=>{l.fx=o.x,l.fy=o.y}).on("end",(o,l)=>{o.active||n.alphaTarget(0),l.fx=null,l.fy=null});e.call(a)}_zoomHandler(e,n){this._zoomBehaviour=function eu(){var c,f,h,t=Wo,e=Ko,n=Jo,r=Yo,i=Zo,s=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=_a,u=ct("start","zoom","end"),d=500,m=0,y=10;function _(p){p.property("__zoom",_r).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",B).on("dblclick.zoom",j).filter(i).on("touchstart.zoom",Q).on("touchmove.zoom",ee).on("touchend.zoom touchcancel.zoom",Z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function R(p,N){return(N=Math.max(s[0],Math.min(s[1],N)))===p.k?p:new me(N,p.x,p.y)}function C(p,N,b){var T=N[0]-b[0]*p.k,P=N[1]-b[1]*p.k;return T===p.x&&P===p.y?p:new me(p.k,T,P)}function g(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function k(p,N,b,T){p.on("start.zoom",function(){F(this,arguments).event(T).start()}).on("interrupt.zoom end.zoom",function(){F(this,arguments).event(T).end()}).tween("zoom",function(){var P=this,D=arguments,L=F(P,D).event(T),$=e.apply(P,D),H=null==b?g($):"function"==typeof b?b.apply(P,D):b,fe=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),U=P.__zoom,ie="function"==typeof N?N.apply(P,D):N,ye=l(U.invert(H).concat(fe/U.k),ie.invert(H).concat(fe/ie.k));return function(se){if(1===se)se=ie;else{var xe=ye(se),fn=fe/xe[2];se=new me(fn,H[0]-xe[0]*fn,H[1]-xe[1]*fn)}L.zoom(null,se)}})}function F(p,N,b){return!b&&p.__zooming||new z(p,N)}function z(p,N){this.that=p,this.args=N,this.active=0,this.sourceEvent=null,this.extent=e.apply(p,N),this.taps=0}function M(p,...N){if(t.apply(this,arguments)){var b=F(this,N).event(p),T=this.__zoom,P=Math.max(s[0],Math.min(s[1],T.k*Math.pow(2,r.apply(this,arguments)))),D=pe(p);if(b.wheel)(b.mouse[0][0]!==D[0]||b.mouse[0][1]!==D[1])&&(b.mouse[1]=T.invert(b.mouse[0]=D)),clearTimeout(b.wheel);else{if(T.k===P)return;b.mouse=[D,T.invert(D)],vt(this),b.start()}rt(p),b.wheel=setTimeout(L,150),b.zoom("mouse",n(C(R(T,P),b.mouse[0],b.mouse[1]),b.extent,a))}function L(){b.wheel=null,b.end()}}function B(p,...N){if(!h&&t.apply(this,arguments)){var b=p.currentTarget,T=F(this,N,!0).event(p),P=ue(p.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",fe,!0),D=pe(p,b),L=p.clientX,$=p.clientY;zn(p.view),un(p),T.mouse=[D,this.__zoom.invert(D)],vt(this),T.start()}function H(U){if(rt(U),!T.moved){var ie=U.clientX-L,ye=U.clientY-$;T.moved=ie*ie+ye*ye>m}T.event(U).zoom("mouse",n(C(T.that.__zoom,T.mouse[0]=pe(U,b),T.mouse[1]),T.extent,a))}function fe(U){P.on("mousemove.zoom mouseup.zoom",null),Dn(U.view,T.moved),rt(U),T.event(U).end()}}function j(p,...N){if(t.apply(this,arguments)){var b=this.__zoom,T=pe(p.changedTouches?p.changedTouches[0]:p,this),P=b.invert(T),D=b.k*(p.shiftKey?.5:2),L=n(C(R(b,D),T,P),e.apply(this,N),a);rt(p),o>0?ue(this).transition().duration(o).call(k,L,T,p):ue(this).call(_.transform,L,T,p)}}function Q(p,...N){if(t.apply(this,arguments)){var D,L,$,H,b=p.touches,T=b.length,P=F(this,N,p.changedTouches.length===T).event(p);for(un(p),L=0;L<T;++L)H=[H=pe($=b[L],this),this.__zoom.invert(H),$.identifier],P.touch0?!P.touch1&&P.touch0[2]!==H[2]&&(P.touch1=H,P.taps=0):(P.touch0=H,D=!0,P.taps=1+!!c);c&&(c=clearTimeout(c)),D&&(P.taps<2&&(f=H[0],c=setTimeout(function(){c=null},d)),vt(this),P.start())}}function ee(p,...N){if(this.__zooming){var D,L,$,H,b=F(this,N).event(p),T=p.changedTouches,P=T.length;for(rt(p),D=0;D<P;++D)$=pe(L=T[D],this),b.touch0&&b.touch0[2]===L.identifier?b.touch0[0]=$:b.touch1&&b.touch1[2]===L.identifier&&(b.touch1[0]=$);if(L=b.that.__zoom,b.touch1){var fe=b.touch0[0],U=b.touch0[1],ie=b.touch1[0],ye=b.touch1[1],se=(se=ie[0]-fe[0])*se+(se=ie[1]-fe[1])*se,xe=(xe=ye[0]-U[0])*xe+(xe=ye[1]-U[1])*xe;L=R(L,Math.sqrt(se/xe)),$=[(fe[0]+ie[0])/2,(fe[1]+ie[1])/2],H=[(U[0]+ye[0])/2,(U[1]+ye[1])/2]}else{if(!b.touch0)return;$=b.touch0[0],H=b.touch0[1]}b.zoom("touch",n(C(L,$,H),b.extent,a))}}function Z(p,...N){if(this.__zooming){var D,L,b=F(this,N).event(p),T=p.changedTouches,P=T.length;for(un(p),h&&clearTimeout(h),h=setTimeout(function(){h=null},d),D=0;D<P;++D)L=T[D],b.touch0&&b.touch0[2]===L.identifier?delete b.touch0:b.touch1&&b.touch1[2]===L.identifier&&delete b.touch1;if(b.touch1&&!b.touch0&&(b.touch0=b.touch1,delete b.touch1),b.touch0)b.touch0[1]=this.__zoom.invert(b.touch0[0]);else if(b.end(),2===b.taps&&(L=pe(L,this),Math.hypot(f[0]-L[0],f[1]-L[1])<y)){var $=ue(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return _.transform=function(p,N,b,T){var P=p.selection?p.selection():p;P.property("__zoom",_r),p!==P?k(p,N,b,T):P.interrupt().each(function(){F(this,arguments).event(T).start().zoom(null,"function"==typeof N?N.apply(this,arguments):N).end()})},_.scaleBy=function(p,N,b,T){_.scaleTo(p,function(){return this.__zoom.k*("function"==typeof N?N.apply(this,arguments):N)},b,T)},_.scaleTo=function(p,N,b,T){_.transform(p,function(){var P=e.apply(this,arguments),D=this.__zoom,L=null==b?g(P):"function"==typeof b?b.apply(this,arguments):b,$=D.invert(L),H="function"==typeof N?N.apply(this,arguments):N;return n(C(R(D,H),L,$),P,a)},b,T)},_.translateBy=function(p,N,b,T){_.transform(p,function(){return n(this.__zoom.translate("function"==typeof N?N.apply(this,arguments):N,"function"==typeof b?b.apply(this,arguments):b),e.apply(this,arguments),a)},null,T)},_.translateTo=function(p,N,b,T,P){_.transform(p,function(){var D=e.apply(this,arguments),L=this.__zoom,$=null==T?g(D):"function"==typeof T?T.apply(this,arguments):T;return n(on.translate($[0],$[1]).scale(L.k).translate("function"==typeof N?-N.apply(this,arguments):-N,"function"==typeof b?-b.apply(this,arguments):-b),D,a)},T,P)},z.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,N){return this.mouse&&"mouse"!==p&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&"touch"!==p&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&"touch"!==p&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var N=ue(this.that).datum();u.call(p,this.that,new Uo(p,{sourceEvent:this.sourceEvent,target:_,type:p,transform:this.that.__zoom,dispatch:u}),N)}},_.wheelDelta=function(p){return arguments.length?(r="function"==typeof p?p:Tt(+p),_):r},_.filter=function(p){return arguments.length?(t="function"==typeof p?p:Tt(!!p),_):t},_.touchable=function(p){return arguments.length?(i="function"==typeof p?p:Tt(!!p),_):i},_.extent=function(p){return arguments.length?(e="function"==typeof p?p:Tt([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),_):e},_.scaleExtent=function(p){return arguments.length?(s[0]=+p[0],s[1]=+p[1],_):[s[0],s[1]]},_.translateExtent=function(p){return arguments.length?(a[0][0]=+p[0][0],a[1][0]=+p[1][0],a[0][1]=+p[0][1],a[1][1]=+p[1][1],_):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},_.constrain=function(p){return arguments.length?(n=p,_):n},_.duration=function(p){return arguments.length?(o=+p,_):o},_.interpolate=function(p){return arguments.length?(l=p,_):l},_.on=function(){var p=u.on.apply(u,arguments);return p===u?_:p},_.clickDistance=function(p){return arguments.length?(m=(p=+p)*p,_):Math.sqrt(m)},_.tapDistance=function(p){return arguments.length?(y=+p,_):y},_}().scaleExtent([this.sliderConfig.min,this.sliderConfig.max]).on("zoom",i=>{const s=i.transform,a=this._roundToNearestScaleStep(s.k);e.attr("transform",s),this._sliderInput.nativeElement.value=a,this._sliderInputLabel.nativeElement.innerText=a+"x",this.sliderConfig.value=a}),n.call(this._zoomBehaviour)}_filterNodesById(e,n){return e.filter(r=>r.id===n)[0]}_filterNodesByType(e,n){return e.filter(r=>r.type===n)}_getContainerWidth(e){return e&&e.nativeElement?e.nativeElement.clientWidth:null}_getContainerHeight(e){return e&&e.nativeElement?e.nativeElement.clientHeight:null}_nodeRadius(e){if(!e)return null;let n=8;return-1!==e.label.indexOf("_:")?n-=1:e.instance||-1!==e.label.indexOf("inst:")?n+=2:(e.owlClass||-1!==e.label.indexOf("inst:"))&&(n+=1),n}_roundToNearestScaleStep(e){const n=this.sliderConfig.step;return((s,a)=>Number(Math.round(Number(s+"e"+a))+"e-"+a))(e,(s=n,Math.floor(s)===s?0:s.toString().split(".")[1].length||0));var s}_triplesToD3GraphData(e){if(!e)return;const n=new S;return e.forEach(r=>{const i=this.prefixPipe.transform(r.subject,ne.short),s=this.prefixPipe.transform(r.predicate,ne.short);let a=this.prefixPipe.transform(r.object,ne.short);isNaN(a)||(a=Number(a)%1==0?String(Number(a)):String(Number(a).toFixed(2)));const o=new ae(s,O.link);n.nodes.push(o);let l=this._filterNodesById(n.nodes,i);null==l&&(l=new ae(i,O.node),n.nodes.push(l));let u=this._filterNodesById(n.nodes,a);null==u&&(u=new ae(a,O.node),n.nodes.push(u)),!1===l.instance&&(l.instance=this._checkForRdfType(o)),!1===u.owlClass&&(u.owlClass=this._checkForRdfType(o)),n.links.push(new E(l,o)),n.links.push(new E(o,u)),n.nodeTriples.push(new wr(l,o,u))}),n}_updateNodePositions(e){e.attr("cx",n=>n.x).attr("cy",n=>n.y)}_updateNodeTextPositions(e){e.attr("x",n=>n.x+12).attr("y",n=>n.y+3)}_updateLinkPositions(e){e.attr("d",n=>{const r=n.nodeSubject.x,i=n.nodeSubject.y;let s=n.nodeObject.x,a=n.nodeObject.y;let l=0,u=0,c=0,f=0;return r===s&&i===a&&(c=-45,f=1,l=30,u=20,s+=1,a+=1),"M"+r+","+i+"A"+l+","+u+" "+c+","+f+",1 "+s+","+a})}_updateLinkTextPositions(e){e.attr("x",n=>n.nodeSubject.x===n.nodeObject.x&&n.nodeSubject.y===n.nodeObject.y?20+(n.nodeSubject.x+n.nodePredicate.x+n.nodeObject.x)/3:10+(n.nodeSubject.x+n.nodePredicate.x+n.nodeObject.x)/3).attr("y",n=>n.nodeSubject.x===n.nodeObject.x&&n.nodeSubject.y===n.nodeObject.y?(n.nodeSubject.y+n.nodePredicate.y+n.nodeObject.y)/3-40:4+(n.nodeSubject.y+n.nodePredicate.y+n.nodeObject.y)/3)}};it.ctorParameters=()=>[{type:Me},{type:De}],it.propDecorators={queryResultTriples:[{type:w.IIB}],height:[{type:w.IIB}],clickedNodeRequest:[{type:w.r_U}],_graphContainer:[{type:w.i9L,args:["graph",{static:!0}]}],_sliderInput:[{type:w.i9L,args:["sliderInput",{static:!0}]}],_sliderInputLabel:[{type:w.i9L,args:["sliderInputLabel",{static:!0}]}],onResize:[{type:w.L6J,args:["window:resize"]}]},it=(0,G.gn)([(0,w.wA2)({selector:"awg-force-graph",template:qe,styles:[Ae]})],it);var tu=I(80),nu=I(1973);let Ct=class{constructor(){this.clickedTableRequest=new w.vpe}isNotEmpty(e){if(e.head&&e.body)return e.head.vars.length>0&&e.body.bindings.length>0}onTableNodeClick(e){!e||this.clickedTableRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}};Ct.propDecorators={queryResult$:[{type:w.IIB}],queryTime:[{type:w.IIB}],isFullscreen:[{type:w.IIB}],clickedTableRequest:[{type:w.r_U}]},Ct=(0,G.gn)([(0,w.wA2)({selector:"awg-select-results",template:tu,changeDetection:w.n4l.OnPush,styles:[nu]})],Ct);var ru=I(6802),iu=I(9495);I(481);let It=class{constructor(){this.performQueryRequest=new w.vpe,this.resetQueryRequest=new w.vpe,this.updateQueryStringRequest=new w.vpe,this.cmSparqlConfig={lineNumbers:!0,firstLineNumber:1,lineWrapping:!0,matchBrackets:!0,mode:"sparql"}}isExampleQueriesEnabled(){return!!(this.query&&this.query.queryType&&this.query.queryLabel&&this.query.queryString&&this.queryList)}onEditorInputChange(e){!e||this.updateQueryStringRequest.emit(e)}onQueryListChange(e){!e||!this.queryList||(e=this.queryList.find(n=>e.queryLabel===n.queryLabel&&e.queryType===n.queryType)||this.queryList[0],this.resetQuery(e))}performQuery(){this.performQueryRequest.emit()}resetQuery(e){!e||this.resetQueryRequest.emit(e)}preventPanelCollapseOnFullscreen(e){!e||this.isFullscreen&&!1===e.nextState&&e.preventDefault()}togglePanel(){return this.isFullscreen?"awg-graph-visualizer-sparql-query":""}};It.propDecorators={sparqlAcc:[{type:w.i9L,args:["sparqlAcc"]}],queryList:[{type:w.IIB}],query:[{type:w.IIB}],isFullscreen:[{type:w.IIB}],performQueryRequest:[{type:w.r_U}],resetQueryRequest:[{type:w.r_U}],updateQueryStringRequest:[{type:w.r_U}]},It=(0,G.gn)([(0,w.wA2)({selector:"awg-sparql-editor",template:ru,changeDetection:w.n4l.OnPush,styles:[iu]})],It);var su=I(2519),au=I(388),ou=I(3756);let Et=class{constructor(e){this.coreService=e}ngOnInit(){this.provideMetaData()}provideMetaData(){this.logos=this.coreService.getLogos()}};Et.ctorParameters=()=>[{type:ou.pX}],Et=(0,G.gn)([(0,w.wA2)({selector:"awg-sparql-no-results",template:su,changeDetection:w.n4l.OnPush,styles:[au]})],Et);var uu=I(4940),lu=I(4775);let Ft=class{constructor(){this.clickedTableRequest=new w.vpe}ngOnInit(){}onTableNodeClick(e){!e||this.clickedTableRequest.emit(e)}};Ft.propDecorators={queryResult:[{type:w.IIB}],queryTime:[{type:w.IIB}],clickedTableRequest:[{type:w.r_U}]},Ft=(0,G.gn)([(0,w.wA2)({selector:"awg-sparql-table",template:uu,changeDetection:w.n4l.OnPush,styles:[lu]})],Ft);var cu=I(8032),hu=I(5898);I(8779);let qt=class{constructor(){this.performQueryRequest=new w.vpe,this.resetTriplesRequest=new w.vpe,this.updateTriplesRequest=new w.vpe,this.cmTriplesConfig={lineNumbers:!0,firstLineNumber:1,lineWrapping:!0,matchBrackets:!0,mode:"turtle"}}onEditorInputChange(e){!e||this.updateTriplesRequest.emit(e)}performQuery(){this.performQueryRequest.emit()}resetTriples(){this.resetTriplesRequest.emit()}preventPanelCollapseOnFullscreen(e){this.isFullscreen&&!1===e.nextState&&e.preventDefault()}togglePanel(){return this.isFullscreen?"awg-graph-visualizer-triples":""}};qt.propDecorators={triplesAcc:[{type:w.i9L,args:["triplesAcc"]}],triples:[{type:w.IIB}],isFullscreen:[{type:w.IIB}],performQueryRequest:[{type:w.r_U}],resetTriplesRequest:[{type:w.r_U}],updateTriplesRequest:[{type:w.r_U}]},qt=(0,G.gn)([(0,w.wA2)({selector:"awg-triples-editor",template:cu,changeDetection:w.n4l.OnPush,styles:[hu]})],qt);var fu=I(5541),du=I(7045);let At=class{};function mr(t,e,n,r,i,s,a){try{var o=t[s](a),l=o.value}catch(u){return void n(u)}o.done?e(l):Promise.resolve(l).then(r,i)}At.propDecorators={queryType:[{type:w.IIB}]},At=(0,G.gn)([(0,w.wA2)({selector:"awg-unsupported-type-results",template:fu,changeDetection:w.n4l.OnPush,styles:[du]})],At);var gu=I(2796),_u=I(1543),mu=I(2076),yr=I(515),xr=I(8592);let Ee=class{constructor(e,n){this.graphVisualizerService=e,this.toastService=n,this.defaultForceGraphHeight=500}ngOnInit(){this.resetTriples(),this.resetQuery()}resetTriples(){!this.graphRDFInputData.triples||(this.triples=this.graphRDFInputData.triples)}resetQuery(e){!this.graphRDFInputData.queryList||(this.queryList=JSON.parse(JSON.stringify(this.graphRDFInputData.queryList)),this.query=e?this.queryList.find(n=>e.queryLabel===n.queryLabel&&e.queryType===n.queryType)||e:this.queryList[0],this.performQuery())}performQuery(){if(this.query.queryString=this.graphVisualizerService.checkNamespacesInQuery(this.query.queryString,this.triples),this.query.queryType=this.graphVisualizerService.getQuerytype(this.query.queryString),"construct"===this.query.queryType||"select"===this.query.queryType){const e=this._queryLocalStore(this.query.queryType,this.query.queryString,this.triples);this.queryResult$=(0,mu.D)(e)}else this.queryResult$=yr.E}onGraphNodeClick(e){!e||console.info("GraphVisualizerComponent# graphClick on node",e)}onTableNodeClick(e){!e||console.info("GraphVisualizerComponent# tableClick on URI",e)}showErrorMessage(e,n,r){if(!n)return;r||(r=7e3);const i=new xr.F(n,{header:e,classname:"bg-danger text-light",delay:r});this.toastService.add(i),console.error(n,r)}_queryLocalStore(e,n,r){var i=this;return function pu(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function a(l){mr(s,r,i,a,o,"next",l)}function o(l){mr(s,r,i,a,o,"throw",l)}a(void 0)})}}(function*(){const s=Date.now();let a;try{a=yield i.graphVisualizerService.doQuery(e,n,r),i.queryTime=Date.now()-s}catch(o){console.error("#queryLocalstore got error:",o),o.message&&o.name&&(-1!==o.message.indexOf("undefined")&&i.showErrorMessage(o.name,"The query did not return any results",1e4),i.showErrorMessage(o.name,o.message,1e4)),i.queryTime=Date.now()-s,a=[]}return a})()}};Ee.ctorParameters=()=>[{type:Me},{type:xr.k}],Ee.propDecorators={fs:[{type:w.i9L,args:["fs"]}],graphRDFInputData:[{type:w.IIB}],isFullscreen:[{type:w.IIB}]},Ee=(0,G.gn)([(0,w.wA2)({selector:"awg-graph-visualizer",template:gu,changeDetection:w.n4l.Default,styles:[_u]})],Ee);let ln=class{};ln=(0,G.gn)([(0,w.LVF)({imports:[Fe.m],declarations:[be,it,Ee,De,Ct,It,Et,Ft,qt,At],exports:[Ee],providers:[Me,De]})],ln);var br=I(8755),yu=I(4263),xu=I(9763),bu=I(9808),vu=I(3900),wu=I(262),Ru=I(5428),vr=I(6900);let Be=class{constructor(e,n,r){this.editionDataService=e,this.editionService=n,this.document=r,this.isFullscreen=!1,this.faExpand=te.TL5,this.faCompress=te.Qj4,this.GRAPH_IMAGES={OP12:"",OP25:Ru.w8.GRAPH_IMAGE_OP25.route},this.errorObject=null,this.ref=this}onKeydownHandler(e){!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(this.isFullscreen=!1)}ngOnInit(){this.getEditionGraphData()}getEditionGraphData(){this.editionGraphData$=this.editionService.getEditionWork().pipe((0,vu.w)(e=>(this.editionWork=e,this.editionDataService.getEditionGraphData(this.editionWork))),(0,wu.K)(e=>(this.errorObject=e,yr.E)))}openFullscreen(){const e=this.child.fs.nativeElement;this.isFullscreen=!0,!this.document.fullscreenElement&&!this.document.mozFullScreenElement&&!this.document.webkitFullscreenElement&&(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}closeFullscreen(){this.document.exitFullscreen?this.document.exitFullscreen():this.document.mozCancelFullScreen?this.document.mozCancelFullScreen():this.document.webkitExitFullscreen?this.document.webkitExitFullscreen():this.document.msExitFullscreen&&this.document.msExitFullscreen(),this.isFullscreen=!1}};Be.ctorParameters=()=>[{type:vr.K},{type:vr.O},{type:void 0,decorators:[{type:w.tBr,args:[bu.K0]}]}],Be.propDecorators={child:[{type:w.i9L,args:[Ee]}],isFullscreen:[{type:w.pfw,args:["class.is-fullscreen"]}],onKeydownHandler:[{type:w.L6J,args:["document:fullscreenchange",["$event"]]}]},Be=(0,G.gn)([(0,w.wA2)({selector:"awg-edition-graph",template:yu,changeDetection:w.n4l.OnPush,styles:[xu]})],Be);const Su=[{path:"",component:Be,data:{title:"AWG Online Edition \u2013 Graph"}}],Nu=[Be];let cn=class{};cn=(0,G.gn)([(0,w.LVF)({imports:[br.Bz.forChild(Su)],exports:[br.Bz]})],cn);let hn=class{};hn=(0,G.gn)([(0,w.LVF)({imports:[Fe.m,ln,cn],declarations:[Nu]})],hn)},481:(q,Ne,I)=>{!function(G){"use strict";G.defineMode("sparql",function(w){var V,Fe=w.indentUnit;function Te(v){return new RegExp("^(?:"+v.join("|")+")$","i")}var be=Te(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","iri","uri","bnode","count","sum","min","max","avg","sample","group_concat","rand","abs","ceil","floor","round","concat","substr","strlen","replace","ucase","lcase","encode_for_uri","contains","strstarts","strends","strbefore","strafter","year","month","day","hours","minutes","seconds","timezone","tz","now","uuid","struuid","md5","sha1","sha256","sha384","sha512","coalesce","if","strlang","strdt","isnumeric","regex","exists","isblank","isliteral","a","bind"]),qe=Te(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","true","false","with","data","copy","to","move","add","create","drop","clear","load"]),Ae=/[*+\-<>=&|\^\/!\?]/;function ve(v,S){var E=v.next();if(V=null,"$"==E||"?"==E)return"?"==E&&v.match(/\s/,!1)?"operator":(v.match(/^[A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][A-Za-z0-9_\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]*/),"variable-2");if("<"==E&&!v.match(/^[\s\u00a0=]/,!1))return v.match(/^[^\s\u00a0>]*>?/),"atom";if('"'==E||"'"==E)return S.tokenize=we(E),S.tokenize(v,S);if(/[{}\(\),\.;\[\]]/.test(E))return V=E,"bracket";if("#"==E)return v.skipToEnd(),"comment";if(Ae.test(E))return"operator";if(":"==E)return Pe(v),"atom";if("@"==E)return v.eatWhile(/[a-z\d\-]/i),"meta";if(v.eatWhile(/[_\w\d]/),v.eat(":"))return Pe(v),"atom";var O=v.current();return be.test(O)?"builtin":qe.test(O)?"keyword":"variable"}function Pe(v){v.match(/(\.(?=[\w_\-\\%])|[:\w_-]|\\[-\\_~.!$&'()*+,;=/?#@%]|%[a-f\d][a-f\d])+/i)}function we(v){return function(S,E){for(var ae,O=!1;null!=(ae=S.next());){if(ae==v&&!O){E.tokenize=ve;break}O=!O&&"\\"==ae}return"string"}}function te(v,S,E){v.context={prev:v.context,indent:v.indent,col:E,type:S}}function A(v){v.indent=v.context.indent,v.context=v.context.prev}return{startState:function(){return{tokenize:ve,context:null,indent:0,col:0}},token:function(v,S){if(v.sol()&&(S.context&&null==S.context.align&&(S.context.align=!1),S.indent=v.indentation()),v.eatSpace())return null;var E=S.tokenize(v,S);if("comment"!=E&&S.context&&null==S.context.align&&"pattern"!=S.context.type&&(S.context.align=!0),"("==V)te(S,")",v.column());else if("["==V)te(S,"]",v.column());else if("{"==V)te(S,"}",v.column());else if(/[\]\}\)]/.test(V)){for(;S.context&&"pattern"==S.context.type;)A(S);S.context&&V==S.context.type&&(A(S),"}"==V&&S.context&&"pattern"==S.context.type&&A(S))}else"."==V&&S.context&&"pattern"==S.context.type?A(S):/atom|string|variable/.test(E)&&S.context&&(/[\}\]]/.test(S.context.type)?te(S,"pattern",v.column()):"pattern"==S.context.type&&!S.context.align&&(S.context.align=!0,S.context.col=v.column()));return E},indent:function(v,S){var E=S&&S.charAt(0),O=v.context;if(/[\]\}]/.test(E))for(;O&&"pattern"==O.type;)O=O.prev;var ae=O&&E==O.type;return O?"pattern"==O.type?O.col:O.align?O.col+(ae?0:1):O.indent+(ae?0:Fe):0},lineComment:"#"}}),G.defineMIME("application/sparql-query","sparql")}(I(8266))},8779:(q,Ne,I)=>{!function(G){"use strict";G.defineMode("turtle",function(w){var V,Fe=w.indentUnit;function Te(A){return new RegExp("^(?:"+A.join("|")+")$","i")}Te([]);var qe=Te(["@prefix","@base","a"]),Ae=/[*+\-<>=&|]/;function ve(A,v){var S=A.next();if(V=null,"<"==S&&!A.match(/^[\s\u00a0=]/,!1))return A.match(/^[^\s\u00a0>]*>?/),"atom";if('"'==S||"'"==S)return v.tokenize=Pe(S),v.tokenize(A,v);if(/[{}\(\),\.;\[\]]/.test(S))return V=S,null;if("#"==S)return A.skipToEnd(),"comment";if(Ae.test(S))return A.eatWhile(Ae),null;if(":"==S)return"operator";if(A.eatWhile(/[_\w\d]/),":"==A.peek())return"variable-3";var E=A.current();return qe.test(E)?"meta":S>="A"&&S<="Z"?"comment":"keyword"}function Pe(A){return function(v,S){for(var O,E=!1;null!=(O=v.next());){if(O==A&&!E){S.tokenize=ve;break}E=!E&&"\\"==O}return"string"}}function we(A,v,S){A.context={prev:A.context,indent:A.indent,col:S,type:v}}function te(A){A.indent=A.context.indent,A.context=A.context.prev}return{startState:function(){return{tokenize:ve,context:null,indent:0,col:0}},token:function(A,v){if(A.sol()&&(v.context&&null==v.context.align&&(v.context.align=!1),v.indent=A.indentation()),A.eatSpace())return null;var S=v.tokenize(A,v);if("comment"!=S&&v.context&&null==v.context.align&&"pattern"!=v.context.type&&(v.context.align=!0),"("==V)we(v,")",A.column());else if("["==V)we(v,"]",A.column());else if("{"==V)we(v,"}",A.column());else if(/[\]\}\)]/.test(V)){for(;v.context&&"pattern"==v.context.type;)te(v);v.context&&V==v.context.type&&te(v)}else"."==V&&v.context&&"pattern"==v.context.type?te(v):/atom|string|variable/.test(S)&&v.context&&(/[\}\]]/.test(v.context.type)?we(v,"pattern",A.column()):"pattern"==v.context.type&&!v.context.align&&(v.context.align=!0,v.context.col=A.column()));return S},indent:function(A,v){var S=v&&v.charAt(0),E=A.context;if(/[\]\}]/.test(S))for(;E&&"pattern"==E.type;)E=E.prev;var O=E&&S==E.type;return E?"pattern"==E.type?E.col:E.align?E.col+(O?0:1):E.indent+(O?0:Fe):0},lineComment:"#"}}),G.defineMIME("text/turtle","turtle")}(I(8266))},352:q=>{let Ne;q.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:global):I=>(Ne||(Ne=Promise.resolve())).then(I).catch(G=>setTimeout(()=>{throw G},0))},9763:q=>{"use strict";q.exports=""},1451:q=>{"use strict";q.exports=""},9020:q=>{"use strict";q.exports='#awg-force-graph-container {\n  position: relative;\n  width: 100%;\n}\n#awg-force-graph-container > .awg-force-graph-icon-bar {\n  position: relative;\n  width: 100%;\n}\n.awg-force-graph-panel-container {\n  position: inherit;\n  height: 100%;\n}\n/* slider */\n.input-group.awg-force-graph-zoom-slider-container {\n  flex-wrap: nowrap;\n  width: auto;\n}\n.input-group.awg-force-graph-zoom-slider-container > :not(:first-child) {\n  margin-left: 0px !important;\n}\n#slider-label.input-group-text {\n  min-width: 50px;\n  color: #149b9e;\n}\n/* slider input */\ninput[type=range].awg-force-graph-zoom-slider {\n  width: 100%;\n  background-color: transparent;\n  -webkit-appearance: none;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus {\n  outline: none;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-lower {\n  background: rgba(221, 221, 221, 0.78);\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-ms-fill-upper {\n  background: #e5e5e5;\n}\ninput[type=range].awg-force-graph-zoom-slider:focus::-webkit-slider-runnable-track {\n  background: #e5e5e5;\n}\ninput[type=range].awg-force-graph-zoom-slider::-webkit-slider-runnable-track {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 1.3px;\n  width: 100%;\n  height: 31px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-webkit-slider-thumb {\n  width: 15px;\n  height: 29px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n  -webkit-appearance: none;\n}\ninput[type=range].awg-force-graph-zoom-slider::-moz-range-track {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 1.3px;\n  width: 100%;\n  height: 29px;\n  cursor: pointer;\n  -moz-margin-start: fill;\n  margin-right: fill;\n}\ninput[type=range].awg-force-graph-zoom-slider::-moz-range-thumb {\n  width: 15px;\n  height: 27px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-track {\n  background: transparent;\n  border-color: transparent;\n  border-width: 7.4px 0;\n  color: transparent;\n  width: 100%;\n  height: 31px;\n  cursor: pointer;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-fill-lower {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 2.6px;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-fill-upper {\n  background: rgba(221, 221, 221, 0.78);\n  border: 0.2px solid #dddddd;\n  border-radius: 2.6px;\n}\ninput[type=range].awg-force-graph-zoom-slider::-ms-thumb {\n  width: 15px;\n  height: 29px;\n  background: #149b9e;\n  border: 1.8px solid #149b9e;\n  border-radius: 10px;\n  cursor: pointer;\n  margin-top: 0px;\n  /*Needed to keep the Edge thumb centred*/\n}\n/* Simulation nodes */\n:host ::ng-deep .node {\n  stroke: #fff;\n  fill: #ddd;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .blank {\n  stroke: #fff;\n  fill: #000 !important;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .blank.instance {\n  stroke: #fff;\n  fill: #000;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .class {\n  stroke: #fff;\n  fill: #9e0000;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .instance {\n  stroke: #fff;\n  fill: lightseagreen;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .instance-space {\n  stroke: #fff;\n  fill: deepskyblue;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .instance-spaceType {\n  stroke: #fff;\n  fill: darkblue;\n  stroke-width: 1.5px;\n}\n:host ::ng-deep .link {\n  fill: none;\n  stroke: #999;\n  stroke-opacity: 0.6;\n  stroke-width: 1px;\n}\n:host ::ng-deep marker {\n  stroke: #999;\n  fill: rgba(124, 240, 10, 0);\n}\n:host ::ng-deep .node-text {\n  font: 15px "Roboto", sans-serif;\n  fill: black;\n}\n:host ::ng-deep .link-text {\n  font: 13px "Roboto", sans-serif;\n  fill: grey;\n}'},1543:q=>{"use strict";q.exports=":host::ng-deep .awg-fullscreen .collapse.show {\n  height: 100vh;\n}\n:host::ng-deep .awg-fullscreen #awg-graph-visualizer-triples.collapse.show {\n  height: 45vh;\n}\n:host::ng-deep .awg-fullscreen #awg-graph-visualizer-query.collapse.show {\n  height: 50vh;\n}"},1973:q=>{"use strict";q.exports=""},9495:q=>{"use strict";q.exports="ngx-codemirror ::ng-deep .CodeMirror {\n  font-size: initial;\n}"},388:q=>{"use strict";q.exports=""},4775:q=>{"use strict";q.exports="ngb-highlight ::ng-deep .ngb-highlight {\n  font-weight: 700;\n  background: yellow;\n}"},5898:q=>{"use strict";q.exports="ngx-codemirror ::ng-deep .CodeMirror {\n  font-size: initial;\n}"},7045:q=>{"use strict";q.exports=""},4263:q=>{"use strict";q.exports='\x3c!-- content: edition graph --\x3e\n<div>\n    \x3c!-- modal --\x3e\n    <awg-modal #modal></awg-modal>\n\n    \x3c!-- graph --\x3e\n    <div class="awg-graph-view p-5 border rounded-3" *ngIf="editionGraphData$ | async as editionGraphData; else error">\n        <div *ngFor="let graph of editionGraphData.graph">\n            \x3c!-- graph description --\x3e\n            <div class="awg-graph-description">\n                <p>\n                    So weit vorhanden, pr\xe4sentiert die vorliegende Ansicht Graph-Visualisierungen des ausgew\xe4hlten\n                    Editionsbereichs: Der <em>statische Graph</em> vermittelt dabei einen von den jeweiligen Editoren\n                    fixierten \xdcberblick editionsrelevanter Zusammenh\xe4nge und Abh\xe4ngigkeiten, der\n                    <em>dynamische Graph</em> bietet zus\xe4tzlich einen interaktiven Zugang zu dem zugrundeliegenden\n                    Datenbestand.\n                    <span class="text-danger"\n                        >Diese Funktionalit\xe4t ist noch nicht f\xfcr alle Skizzenbestandteile verf\xfcgbar, wird aber\n                        sukzessive erg\xe4nzt.</span\n                    >\n                </p>\n                <ng-container *ngIf="graph.description">\n                    <p\n                        *ngFor="let description of graph.description"\n                        [compile-html]="description"\n                        [compile-html-ref]="ref"></p>\n                </ng-container>\n            </div>\n\n            \x3c!-- dynamic graph --\x3e\n            <div class="awg-graph-dynamic" *ngIf="graph.rdfData && graph.rdfData.triples && graph.rdfData.queryList">\n                <h4>\n                    Dynamischer Graph\n                    <button\n                        type="button"\n                        class="btn btn-sm btn-outline-info ms-2"\n                        (click)="modal.open(\'HINT_EDITION_GRAPH\')">\n                        Hinweise zur Nutzung\n                    </button>\n                    <button\n                        type="button"\n                        title="Open fullscreen"\n                        class="btn btn-sm btn-outline-info ms-2"\n                        (click)="openFullscreen()"\n                        *ngIf="!isFullscreen">\n                        <fa-icon [icon]="faExpand"></fa-icon>\n                    </button>\n                    <button\n                        type="button"\n                        title="Close fullscreen"\n                        class="btn btn-sm btn-info ms-2"\n                        (click)="closeFullscreen()"\n                        *ngIf="isFullscreen">\n                        <fa-icon [icon]="faCompress"></fa-icon>\n                    </button>\n                </h4>\n                <p>\n                    Diese interaktive Visualisierung basiert auf Mads Holten\'s\n                    <a href="https://github.com/MadsHolten/sparql-visualizer">SPARQL Visualizer</a>. Sie modelliert den\n                    aktuellen Skizzenkomplex in Form eines <a href="https://www.w3.org/RDF/">RDF</a>-Graphen. Die\n                    zugrundeliegenden RDF-Daten sind unter dem Punkt <em>RDF Triples</em> einsehbar und lokal\n                    editierbar. Eine Filterung und Eingrenzung dieser RDF-Daten kann mithilfe der Abfragesprache\n                    <a href="https://www.w3.org/TR/sparql11-query/">SPARQL</a>\n                    unter dem Punkt <em>SPARQL Abfrage</em> vorgenommen werden; in der Voreinstellung werden hierbei\n                    alle vorhandenen Triples abgefragt.\n                </p>\n                <awg-graph-visualizer\n                    [graphRDFInputData]="graph.rdfData"\n                    [isFullscreen]="isFullscreen"></awg-graph-visualizer>\n            </div>\n\n            \x3c!-- static image --\x3e\n            <div class="awg-graph-static mt-3" *ngIf="graph.staticImage && graph.staticImage !== \'\'">\n                <h4>Statischer Graph</h4>\n                <div [compile-html]="graph.staticImage" [compile-html-ref]="ref"></div>\n            </div>\n        </div>\n    </div>\n\n    \x3c!-- error message --\x3e\n    <ng-template #error>\n        <div class="errorMessage" *ngIf="errorObject">\n            <div class="col-12 text-center">\n                <div class="alert alert-danger">{{ errorObject | json }}</div>\n            </div>\n        </div>\n    </ng-template>\n</div>\n'},3338:q=>{"use strict";q.exports='<ngb-accordion\n    #constructResultsAcc="ngbAccordion"\n    activeIds="awg-graph-visualizer-construct-results"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-construct-results" title="Resultat">\n        <ng-template ngbPanelContent>\n            <ng-container *ngIf="queryResult$ | async as queryResult; else loading">\n                <ng-container *ngIf="queryResult.length > 0; else noResult">\n                    \x3c!-- Force graph visualization --\x3e\n                    <awg-force-graph\n                        class="full-width"\n                        [queryResultTriples]="queryResult"\n                        [height]="defaultForceGraphHeight"\n                        (clickedNodeRequest)="onGraphNodeClick($event)">\n                    </awg-force-graph>\n                </ng-container>\n                <ng-template #noResult>\n                    <awg-sparql-no-results></awg-sparql-no-results>\n                </ng-template>\n            </ng-container>\n            <ng-template #loading>\n                <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n            </ng-template>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},5534:q=>{"use strict";q.exports='<div id="awg-force-graph-container" class="awg-forc-graph-panel-container" [ngStyle]="{ \'height.px\': height }" #graph>\n    <div class="awg-force-graph-icon-bar">\n        \x3c!-- Slider --\x3e\n        <div class="input-group input-group-sm awg-force-graph-zoom-slider-container float-start mb-3">\n            <span #sliderInputLabel class="input-group-text" id="slider-label">{{ sliderConfig.value }}x</span>\n            <input\n                type="range"\n                #sliderInput\n                class="awg-force-graph-zoom-slider"\n                id="awg-force-graph-zoom-slider"\n                name="zoomSlider"\n                aria-label="Zoom slider"\n                aria-describedby="slider-label"\n                [min]="sliderConfig.min"\n                [max]="sliderConfig.max"\n                [step]="sliderConfig.step"\n                [(ngModel)]="sliderConfig.value"\n                (ngModelChange)="onZoomChange($event)" />\n            <button class="btn btn-sm btn-outline-info" type="submit" title="Reset" (click)="onReCenter()">\n                <fa-icon [icon]="faCompressArrowsAlt"></fa-icon>\n            </button>\n        </div>\n\n        \x3c!-- Limit --\x3e\n        <div class="btn-group awg-force-graph-node-limit-container float-end my-auto" *ngIf="queryResultTriples">\n            <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">\n                <span *ngIf="limit < queryResultTriples.length">{{ limit }} von </span\n                >{{ queryResultTriples.length }} Triples\n            </button>\n            <div\n                class="btn-group"\n                ngbDropdown\n                container="body"\n                role="group"\n                aria-label="Button group with nested dropdown for node limit">\n                <button\n                    class="btn btn-sm btn-info dropdown-toggle-split"\n                    ngbDropdownToggle\n                    [disabled]="queryResultTriples.length === 0"></button>\n                <div class="dropdown-menu" ngbDropdownMenu>\n                    <ng-container *ngFor="let limitValue of limitValues">\n                        <button\n                            *ngIf="queryResultTriples.length > limitValue"\n                            class="dropdown-item"\n                            (click)="onLimitValueChange(limitValue)">\n                            <span>{{ limitValue }}</span>\n                        </button>\n                    </ng-container>\n                    <button class="dropdown-item" (click)="onLimitValueChange(queryResultTriples.length)">\n                        <span>Kein Limit</span>\n                    </button>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- <span *ngIf="message" class="message">{{message}}</span> --\x3e\n    </div>\n</div>\n'},2796:q=>{"use strict";q.exports='\x3c!-- Data: Triples, SPARQL query, result --\x3e\n<div #fs class="row awg-graph-visualizer" [class.is-fullscreen]="isFullscreen" *ngIf="graphRDFInputData">\n    <div [ngClass]="isFullscreen ? \'col-4 col-lg-3 px-0 awg-fullscreen\' : \'col-12\'">\n        <div [ngClass]="{ row: !isFullscreen }">\n            <div [ngClass]="{ \'col-6 pe-lg-0\': !isFullscreen }">\n                \x3c!-- awg-graph-triples-editor --\x3e\n                <awg-triples-editor\n                    [triples]="triples"\n                    [isFullscreen]="isFullscreen"\n                    (updateTriplesRequest)="triples = $event"\n                    (resetTriplesRequest)="resetTriples()"\n                    (performQueryRequest)="performQuery()"></awg-triples-editor>\n            </div>\n\n            \x3c!-- awg-graph-sparql-editor --\x3e\n            <div [ngClass]="{ \'col-6 ps-lg-0\': !isFullscreen }">\n                <awg-sparql-editor\n                    [queryList]="queryList"\n                    [query]="query"\n                    [isFullscreen]="isFullscreen"\n                    (updateQueryStringRequest)="query.queryString = $event"\n                    (resetQueryRequest)="resetQuery($event)"\n                    (performQueryRequest)="performQuery()"></awg-sparql-editor>\n            </div>\n        </div>\n    </div>\n\n    \x3c!-- Results --\x3e\n    <div [ngClass]="isFullscreen ? \'col-8 col-lg-9 px-0 awg-fullscreen\' : \'col-12\'">\n        \x3c!-- CONSTRUCT --\x3e\n        \x3c!-- awg-graph-construct-result --\x3e\n        <awg-construct-results\n            #queryConstructResultAcc\n            *ngIf="query.queryType === \'construct\'; else querySelectResultAcc"\n            [queryResult$]="queryResult$"\n            [defaultForceGraphHeight]="isFullscreen ? 1000 : defaultForceGraphHeight"\n            [isFullscreen]="isFullscreen"\n            (clickedNodeRequest)="onGraphNodeClick($event)"></awg-construct-results>\n\n        \x3c!-- SELECT --\x3e\n        \x3c!-- awg-graph-select-result --\x3e\n        <ng-template #querySelectResultAcc>\n            <awg-select-results\n                *ngIf="query.queryType === \'select\'; else queryUnsupportedTypeAcc"\n                [queryResult$]="queryResult$"\n                [queryTime]="queryTime"\n                [isFullscreen]="isFullscreen"\n                (clickedTableRequest)="onTableNodeClick($event)"></awg-select-results>\n        </ng-template>\n\n        \x3c!-- OTHERS --\x3e\n        \x3c!-- awg-graph-unsupported-query-type-result --\x3e\n        <ng-template #queryUnsupportedTypeAcc>\n            <awg-unsupported-type-results [queryType]="query.queryType"></awg-unsupported-type-results>\n        </ng-template>\n    </div>\n</div>\n\n<awg-toast aria-live="polite" aria-atomic="true"></awg-toast>\n'},80:q=>{"use strict";q.exports='<ngb-accordion\n    #selectResultsAcc="ngbAccordion"\n    activeIds="awg-graph-visualizer-select-results"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-select-results" title="Resultat">\n        <ng-template ngbPanelContent>\n            <ng-container *ngIf="queryResult$ | async as queryResult; else loading">\n                <ng-container *ngIf="isNotEmpty(queryResult); else noResult">\n                    \x3c!-- SPARQL table visualization --\x3e\n                    <awg-sparql-table\n                        [queryResult]="queryResult"\n                        [queryTime]="queryTime"\n                        (clickedTableRequest)="onTableNodeClick($event)">\n                    </awg-sparql-table>\n                </ng-container>\n                <ng-template #noResult>\n                    <awg-sparql-no-results></awg-sparql-no-results>\n                </ng-template>\n            </ng-container>\n            <ng-template #loading>\n                <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n            </ng-template>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},6802:q=>{"use strict";q.exports='<ngb-accordion\n    #sparqlAcc="ngbAccordion"\n    [activeIds]="togglePanel()"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-sparql-query">\n        <ng-template ngbPanelHeader>\n            <div class="accordion-button awg-accordion-button-custom-header justify-content-between">\n                <button ngbPanelToggle class="p-0 btn btn-link text-start">SPARQL</button>\n\n                \x3c!-- Example Query Handle --\x3e\n                <div class="p-0 btn-group" *ngIf="isExampleQueriesEnabled()" style="padding: -3rem">\n                    <button type="button" class="btn btn-sm btn-outline-info" disabled aria-disabled="true">\n                        Beispielabfragen\n                    </button>\n                    <div\n                        class="btn-group"\n                        ngbDropdown\n                        container="body"\n                        placement="bottom-right"\n                        role="group"\n                        aria-label="Button group with nested dropdown for sample queries">\n                        <button class="btn btn-sm btn-info" ngbDropdownToggle></button>\n                        <div ngbDropdownMenu>\n                            <h6 class="dropdown-header">Graph-Ansicht (CONSTRUCT)</h6>\n                            <ng-container *ngFor="let q of queryList">\n                                <ng-container *ngIf="q.queryType === \'construct\'">\n                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">\n                                        <span>{{ q.queryLabel }}</span>\n                                    </a>\n                                </ng-container>\n                            </ng-container>\n                            <div class="dropdown-divider"></div>\n                            <h6 class="dropdown-header">Tabellen-Ansicht (SELECT)</h6>\n                            <ng-container *ngFor="let q of queryList">\n                                <ng-container *ngIf="q.queryType === \'select\'">\n                                    <a ngbDropdownItem [class.disabled]="q === query" (click)="onQueryListChange(q)">\n                                        <span>{{ q.queryLabel }}</span>\n                                    </a>\n                                </ng-container>\n                            </ng-container>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ng-template>\n        <ng-template ngbPanelContent>\n            \x3c!-- CodeMirror editor instance --\x3e\n            <ngx-codemirror\n                [(ngModel)]="query.queryString"\n                (ngModelChange)="onEditorInputChange($event)"\n                [options]="cmSparqlConfig">\n            </ngx-codemirror>\n\n            \x3c!-- Handle buttons --\x3e\n            <div fxLayout="row" class="mt-2 awg-graph-visualizer-sparql-query-handle-buttons">\n                <button class="btn btn-info" (click)="performQuery()">Query</button>\n                <button class="btn btn-outline-info" (click)="resetQuery(query)">Reset</button>\n            </div>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},2519:q=>{"use strict";q.exports='<div class="text-center">\n    <p>Entschuldigung, Ihre SPARQL-Anfrage f\xfchrte leider zu keinem Ergebnis.</p>\n    <p>M\xf6glicherweise k\xf6nnen Sie Ihre Anfrage anpassen.</p>\n    <p>\n        Ausf\xfchrliche Informationen zu SPARQL finden Sie unter:\n        <a href="{{ logos.sparql.href }}">{{ logos.sparql.href }}</a\n        >.\n    </p>\n    <p>\n        <a href="{{ logos.sparql.href }}">\n            <img width="33%" src="{{ logos.sparql.src }}" alt="{{ logos.sparql.alt }}" />\n        </a>\n    </p>\n</div>\n'},4940:q=>{"use strict";q.exports='<awg-table\n    *ngIf="queryResult"\n    [tableTitle]="\'SELECT Anfrage\'"\n    [headerInputData]="queryResult.head.vars"\n    [rowInputData]="queryResult.body.bindings"\n    (clickedTableValueRequest)="onTableNodeClick($event)"\n    (clickedTableRowRequest)="(undefined)"></awg-table>\n'},8032:q=>{"use strict";q.exports='<ngb-accordion\n    #triplesAcc="ngbAccordion"\n    [activeIds]="togglePanel()"\n    (panelChange)="preventPanelCollapseOnFullscreen($event)">\n    <ngb-panel id="awg-graph-visualizer-triples" title="RDF Triples">\n        <ng-template ngbPanelContent>\n            \x3c!-- CodeMirror editor instance --\x3e\n            <ngx-codemirror\n                [(ngModel)]="triples"\n                (ngModelChange)="onEditorInputChange($event)"\n                [options]="cmTriplesConfig">\n            </ngx-codemirror>\n\n            \x3c!-- Handle buttons --\x3e\n            <div fxLayout="row" class="mt-2">\n                <button class="btn btn-info" (click)="performQuery()">Query</button>\n                <button class="btn btn-outline-info" (click)="resetTriples()">Reset</button>\n            </div>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'},5541:q=>{"use strict";q.exports='<ngb-accordion activeIds="awg-graph-visualizer-unsupported-query-type-result">\n    <ngb-panel id="awg-graph-visualizer-unsupported-query-type-result" title="Resultat">\n        <ng-template ngbPanelContent>\n            <p class="text-center">\n                Sorry, but the requested SPARQL query type {{ queryType | uppercase }} is not supported yet.\n            </p>\n            <p class="text-center">Please try a CONSTRUCT or SELECT query instead.</p>\n        </ng-template>\n    </ngb-panel>\n</ngb-accordion>\n'}}]);